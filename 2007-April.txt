From dasenjo at mail.berlios.de  Sun Apr  1 11:23:32 2007
From: dasenjo at mail.berlios.de (dasenjo at BerliOS)
Date: Sun, 1 Apr 2007 11:23:32 +0200
Subject: [Destar-dev] r647 - branches/0.2.X trunk
Message-ID: <200704010923.l319NW1u030854@sheep.berlios.de>

Author: dasenjo
Date: 2007-04-01 11:23:31 +0200 (Sun, 01 Apr 2007)
New Revision: 647

Modified:
   branches/0.2.X/cfg_app_meetme.py
   branches/0.2.X/configlets.py
   trunk/cfg_app_meetme.py
   trunk/configlets.py
Log:
* Meetme configuration adjustments. Pin an dynamic rooms work.
* Added __init__ and fixup methods th CfgApp in configlets.py



Modified: branches/0.2.X/cfg_app_meetme.py
===================================================================
--- branches/0.2.X/cfg_app_meetme.py	2007-03-23 17:52:06 UTC (rev 646)
+++ branches/0.2.X/cfg_app_meetme.py	2007-04-01 09:23:31 UTC (rev 647)
@@ -25,22 +25,55 @@
 
 	shortName   = _("Meeting room")
 	newObjectTitle  = _("New meeting room")
+	description= _("Application that let create dynamic conferencing rooms")
 	
 	def createVariables(self):
-		self.variables   = [	VarType("pbx",    title=_("Virtual PBX"), type="choice", options=getChoice("CfgOptPBX")),
-			VarType("ext",      title=_("Extension"), len=6),
-		       	VarType("confno",   title=_("Conference number"), hint=_("If empty, will be the same as the extension"), optional=True, len=6),
-		       	VarType("pin",      title=_("PIN"), optional=True, len=6),
+		self.variables   = [
+			VarType("pbx",
+				title=_("Virtual PBX"),
+				type="choice",
+				options=getChoice("CfgOptPBX")),
+
+			VarType("ext",
+				title=_("Extension"),
+				len=6),
+
+			VarType("timeout",
+				title=_("Maximun duration in seconds?"),
+				type="int",
+				default=1200,
+				len=6),
+
+		       	VarType("confno",
+				title=_("Conference number"),
+				optional=True,
+				type="int",
+				len=6),
+
+		       	VarType("pin",
+				title=_("PIN"),
+				optional=True,
+				type="int",
+				len=6),
 			
-			VarType("panelLab",   title=_("Operator Panel"), type="label", hide=True),
-	                VarType("panel",      title=_("Show this trunk in the panel"), type="bool", hide=True, optional=True)
-		]
+			VarType("panelLab",
+				title=_("Operator Panel"),
+				type="label",
+				hide=True),
+
+	                VarType("panel",
+				title=_("Show this trunk in the panel"),
+				type="bool",
+				hide=True,
+				optional=True)]
+			
 		self.dependencies = [ DepType("pbx", 
 					type="hard",
 					message = _("This is a Dependency")),
 					]
 	
 	def fixup(self):
+		Cfg.fixup(self)
 		self.lookPanel()
 
 	def createAsteriskConfig(self):
@@ -50,23 +83,24 @@
 		c = AstConf("extensions.conf")
 		c.setSection(self.pbx)
 		c.appendExten(self.ext, "Answer")
-		c.appendExten(self.ext, "Wait(1)")
+		c.appendExten(self.ext, "Set(TIMEOUT(absolute)=%d)" % self.timeout)
 		# 'd' -- dynamically add conference
-		# 'p' -- allow user to exit the conference by pressing '#'
-		if not self.confno:
-			self.confno = self.ext
-		c.appendExten(self.ext, "MeetMe(%s,dp)" % self.confno)
+		# 'P' -- always prompt pin
+		args=""
+		if self.confno:
+			args += "%d" % self.confno
+		args += "|d"
+		if self.pin:
+			args += "P|%d" % self.pin
+		c.appendExten(self.ext, "MeetMe(%s)" % args)
 
-		c = AstConf("meetme.conf")
-		c.setSection("rooms")
-		try:
+		if self.confno:
+			c = AstConf("meetme.conf")
+			c.setSection("rooms")
+			room = str(self.confno)
 			if self.pin:
-				c.append("conf=%s,%s" % (self.confno, self.pin))
-			else:
-				c.append("conf=%s" % self.confno)
-		except AttributeError:
-			pass
-		
+				room += ",%d" % self.pin
+			c.append("conf=%s" % room)
 		try:
 			if panelutils.isConfigured() == 1 and self.panel:
 				panelutils.createMeetmeButton(self)

Modified: branches/0.2.X/configlets.py
===================================================================
--- branches/0.2.X/configlets.py	2007-03-23 17:52:06 UTC (rev 646)
+++ branches/0.2.X/configlets.py	2007-04-01 09:23:31 UTC (rev 647)
@@ -1118,6 +1118,12 @@
 
 	groupName ="Applications"
 
+	def __init__(self,**kw):
+		Cfg.__init__(self,**kw)
+
+	def fixup(self):
+		Cfg.fixup(self)
+
 	def head(self):
 		return (_("Extension"), _("Type"), _("Virtual PBX"))
 

Modified: trunk/cfg_app_meetme.py
===================================================================
--- trunk/cfg_app_meetme.py	2007-03-23 17:52:06 UTC (rev 646)
+++ trunk/cfg_app_meetme.py	2007-04-01 09:23:31 UTC (rev 647)
@@ -25,22 +25,55 @@
 
 	shortName   = _("Meeting room")
 	newObjectTitle  = _("New meeting room")
+	description= _("Application that let create dynamic conferencing rooms")
 	
 	def createVariables(self):
-		self.variables   = [	VarType("pbx",    title=_("Virtual PBX"), type="choice", options=getChoice("CfgOptPBX")),
-			VarType("ext",      title=_("Extension"), len=6),
-		       	VarType("confno",   title=_("Conference number"), hint=_("If empty, will be the same as the extension"), optional=True, len=6),
-		       	VarType("pin",      title=_("PIN"), optional=True, len=6),
+		self.variables   = [
+			VarType("pbx",
+				title=_("Virtual PBX"),
+				type="choice",
+				options=getChoice("CfgOptPBX")),
+
+			VarType("ext",
+				title=_("Extension"),
+				len=6),
+
+			VarType("timeout",
+				title=_("Maximun duration in seconds?"),
+				type="int",
+				default=1200,
+				len=6),
+
+		       	VarType("confno",
+				title=_("Conference number"),
+				optional=True,
+				type="int",
+				len=6),
+
+		       	VarType("pin",
+				title=_("PIN"),
+				optional=True,
+				type="int",
+				len=6),
 			
-			VarType("panelLab",   title=_("Operator Panel"), type="label", hide=True),
-	                VarType("panel",      title=_("Show this trunk in the panel"), type="bool", hide=True, optional=True)
-		]
+			VarType("panelLab",
+				title=_("Operator Panel"),
+				type="label",
+				hide=True),
+
+	                VarType("panel",
+				title=_("Show this trunk in the panel"),
+				type="bool",
+				hide=True,
+				optional=True)]
+			
 		self.dependencies = [ DepType("pbx", 
 					type="hard",
 					message = _("This is a Dependency")),
 					]
 	
 	def fixup(self):
+		Cfg.fixup(self)
 		self.lookPanel()
 
 	def createAsteriskConfig(self):
@@ -50,23 +83,24 @@
 		c = AstConf("extensions.conf")
 		c.setSection(self.pbx)
 		c.appendExten(self.ext, "Answer")
-		c.appendExten(self.ext, "Wait(1)")
+		c.appendExten(self.ext, "Set(TIMEOUT(absolute)=%d)" % self.timeout)
 		# 'd' -- dynamically add conference
-		# 'p' -- allow user to exit the conference by pressing '#'
-		if not self.confno:
-			self.confno = self.ext
-		c.appendExten(self.ext, "MeetMe(%s,dp)" % self.confno)
+		# 'P' -- always prompt pin
+		args=""
+		if self.confno:
+			args += "%d" % self.confno
+		args += "|d"
+		if self.pin:
+			args += "P|%d" % self.pin
+		c.appendExten(self.ext, "MeetMe(%s)" % args)
 
-		c = AstConf("meetme.conf")
-		c.setSection("rooms")
-		try:
+		if self.confno:
+			c = AstConf("meetme.conf")
+			c.setSection("rooms")
+			room = str(self.confno)
 			if self.pin:
-				c.append("conf=%s,%s" % (self.confno, self.pin))
-			else:
-				c.append("conf=%s" % self.confno)
-		except AttributeError:
-			pass
-		
+				room += ",%d" % self.pin
+			c.append("conf=%s" % room)
 		try:
 			if panelutils.isConfigured() == 1 and self.panel:
 				panelutils.createMeetmeButton(self)

Modified: trunk/configlets.py
===================================================================
--- trunk/configlets.py	2007-03-23 17:52:06 UTC (rev 646)
+++ trunk/configlets.py	2007-04-01 09:23:31 UTC (rev 647)
@@ -1122,6 +1122,12 @@
 
 	groupName ="Applications"
 
+	def __init__(self,**kw):
+		Cfg.__init__(self,**kw)
+
+	def fixup(self):
+		Cfg.fixup(self)
+
 	def head(self):
 		return (_("Extension"), _("Type"), _("Virtual PBX"))
 



From dasenjo at mail.berlios.de  Sun Apr  1 11:29:04 2007
From: dasenjo at mail.berlios.de (dasenjo at BerliOS)
Date: Sun, 1 Apr 2007 11:29:04 +0200
Subject: [Destar-dev] r648 - branches/0.2.X trunk
Message-ID: <200704010929.l319T4Qe031150@sheep.berlios.de>

Author: dasenjo
Date: 2007-04-01 11:29:03 +0200 (Sun, 01 Apr 2007)
New Revision: 648

Modified:
   branches/0.2.X/CHANGELOG.txt
   trunk/CHANGELOG.txt
Log:
* Missed CHANGELOG entries.



Modified: branches/0.2.X/CHANGELOG.txt
===================================================================
--- branches/0.2.X/CHANGELOG.txt	2007-04-01 09:23:31 UTC (rev 647)
+++ branches/0.2.X/CHANGELOG.txt	2007-04-01 09:29:03 UTC (rev 648)
@@ -1,3 +1,7 @@
+2007-04-01:
+* Meetme configuration adjustments. Pin an dynamic rooms work.
+* Added __init__ and fixup methods th CfgApp in configlets.py
+
 2007-03-22:
 * Fixed permissions for the default Manager API Access
 

Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-01 09:23:31 UTC (rev 647)
+++ trunk/CHANGELOG.txt	2007-04-01 09:29:03 UTC (rev 648)
@@ -1,3 +1,7 @@
+2007-04-01:
+* Meetme configuration adjustments. Pin an dynamic rooms work.
+* Added __init__ and fixup methods th CfgApp in configlets.py
+
 2007-03-22:
 * Fixed permissions for the default Manager API Access
 



From santiago at mail.berlios.de  Wed Apr 11 01:55:27 2007
From: santiago at mail.berlios.de (santiago at BerliOS)
Date: Wed, 11 Apr 2007 01:55:27 +0200
Subject: [Destar-dev] r649 - trunk
Message-ID: <200704102355.l3ANtRuv016320@sheep.berlios.de>

Author: santiago
Date: 2007-04-11 01:55:26 +0200 (Wed, 11 Apr 2007)
New Revision: 649

Modified:
   trunk/CHANGELOG.txt
   trunk/cfg_trunk_sip.py
Log:
* Added port option for sip trunks



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-01 09:29:03 UTC (rev 648)
+++ trunk/CHANGELOG.txt	2007-04-10 23:55:26 UTC (rev 649)
@@ -1,3 +1,6 @@
+2007-04-10:
+* Added port option in sip trunks
+
 2007-04-01:
 * Meetme configuration adjustments. Pin an dynamic rooms work.
 * Added __init__ and fixup methods th CfgApp in configlets.py

Modified: trunk/cfg_trunk_sip.py
===================================================================
--- trunk/cfg_trunk_sip.py	2007-04-01 09:29:03 UTC (rev 648)
+++ trunk/cfg_trunk_sip.py	2007-04-10 23:55:26 UTC (rev 649)
@@ -47,7 +47,13 @@
 			VarType("host",
 				title=_("SIP host"),
 				len=25),
-				
+
+			VarType("port",
+				title=_("SIP port"),
+				type="int",
+				default=5060,
+				len=5),				
+
 			VarType("register",
 				title=_("Register with remote host?"),
 				type="bool"),
@@ -171,7 +177,10 @@
 		c = AstConf("sip.conf")
 		c.setSection("general")
 		if self.register:
-			c.append("register=%s:%s@%s" % (self.id, self.pw, self.host))
+			if not self.port:
+				c.append("register=%s:%s@%s" % (self.id, self.pw, self.host))
+			else:
+				c.append("register=%s:%s@%s:%s" % (self.id, self.pw, self.host, self.port))
 
 		if not c.hasSection(self.name):
 			c.setSection(self.name)



From santiago at mail.berlios.de  Wed Apr 11 01:59:35 2007
From: santiago at mail.berlios.de (santiago at BerliOS)
Date: Wed, 11 Apr 2007 01:59:35 +0200
Subject: [Destar-dev] r650 - branches/0.2.X
Message-ID: <200704102359.l3ANxZQv016750@sheep.berlios.de>

Author: santiago
Date: 2007-04-11 01:59:34 +0200 (Wed, 11 Apr 2007)
New Revision: 650

Modified:
   branches/0.2.X/CHANGELOG.txt
   branches/0.2.X/cfg_trunk_sip.py
Log:
* Added port option in sip trunks




Modified: branches/0.2.X/CHANGELOG.txt
===================================================================
--- branches/0.2.X/CHANGELOG.txt	2007-04-10 23:55:26 UTC (rev 649)
+++ branches/0.2.X/CHANGELOG.txt	2007-04-10 23:59:34 UTC (rev 650)
@@ -1,3 +1,6 @@
+2007-04-10:
+* Added port option in sip trunks
+
 2007-04-01:
 * Meetme configuration adjustments. Pin an dynamic rooms work.
 * Added __init__ and fixup methods th CfgApp in configlets.py

Modified: branches/0.2.X/cfg_trunk_sip.py
===================================================================
--- branches/0.2.X/cfg_trunk_sip.py	2007-04-10 23:55:26 UTC (rev 649)
+++ branches/0.2.X/cfg_trunk_sip.py	2007-04-10 23:59:34 UTC (rev 650)
@@ -47,6 +47,12 @@
 			VarType("host",
 				title=_("SIP host"),
 				len=25),
+
+			VarType("port",
+				title=_("SIP port"),
+				type="int",
+				default=5060,
+				len=5),				
 				
 			VarType("register",
 				title=_("Register with remote host?"),
@@ -171,7 +177,10 @@
 		c = AstConf("sip.conf")
 		c.setSection("general")
 		if self.register:
-			c.append("register=%s:%s@%s" % (self.id, self.pw, self.host))
+			if not self.port:
+				c.append("register=%s:%s@%s" % (self.id, self.pw, self.host))
+			else:
+				c.append("register=%s:%s@%s:%s" % (self.id, self.pw, self.host, self.port))
 
 		if not c.hasSection(self.name):
 			c.setSection(self.name)



From admin at berlios.de  Wed Apr 11 02:05:26 2007
From: admin at berlios.de (admin at berlios.de)
Date: Tue, 10 Apr 2007 19:05:26 -0500 (COT)
Subject: [Destar-dev] [Feature #2813] port field in trunk menu
Message-ID: <200704110005.l3B05QnN018331@unicorn.berlios.de>

Feature Request #2813, was updated on 2006-Oct-26 11:53
You can respond by visiting: 
http://developer.berlios.de/feature/?func=detailfeature&feature_id=2813&group_id=2112

Category: None
Status: Closed
Priority: 5
Summary: port field in trunk menu

By: santiago
Date: 2007-Apr-10 19:05

Message:
Logged In: YES 
user_id=13352
Browser: Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.2) Gecko/20070208 Iceweasel/2.0.0.2 (Debian-2.0.0.2+dfsg-3)

done in svn, for both trunk and 0.2X branch

----------------------------------------------------------------------

By: quelo
Date: 2006-Oct-26 11:53

Message:
Logged In: YES 
user_id=32941
Browser: Mozilla/5.0 (X11; U; Linux i686; it; rv:1.8.0.7) Gecko/20060830 Firefox/1.5.0.7 (Debian-1.5.dfsg+1.5.0.7-1)

I suggest a field to specify the TCP port, for example
if I want to register my pbx with messagenet VoIP
provider... is necessary to specify the 5061 TCP port.

----------------------------------------------------------------------
You can respond by visiting: 
http://developer.berlios.de/feature/?func=detailfeature&feature_id=2813&group_id=2112


From dasenjo at mail.berlios.de  Wed Apr 11 22:37:40 2007
From: dasenjo at mail.berlios.de (dasenjo at BerliOS)
Date: Wed, 11 Apr 2007 22:37:40 +0200
Subject: [Destar-dev] r651 - trunk
Message-ID: <200704112037.l3BKbeN6003110@sheep.berlios.de>

Author: dasenjo
Date: 2007-04-11 22:37:40 +0200 (Wed, 11 Apr 2007)
New Revision: 651

Modified:
   trunk/cfg_app_callfw.py
   trunk/cfg_app_dnd.py
   trunk/cfg_app_quickdial_global.py
   trunk/cfg_app_quickdial_phone.py
Log:
* Fixed extension configuration checking.



Modified: trunk/cfg_app_callfw.py
===================================================================
--- trunk/cfg_app_callfw.py	2007-04-10 23:59:34 UTC (rev 650)
+++ trunk/cfg_app_callfw.py	2007-04-11 20:37:40 UTC (rev 651)
@@ -33,7 +33,7 @@
 			VarType("type", title=_("Type"), type="choice", options=( ("CFIM", _("Call Forwarding Unconditional")), \
 			("CFBS", _("Call Forwarding if Busy")), ("CFTO", _("Call Forwarding if Timeout/Unavailable")) )),
 			VarType("set",      title=_("Setting preffix"), len=6, default="*21"),
-			VarType("ext",   title=_("Unsetting extension"), len=6, default="*22"),
+			VarType("unset",   title=_("Unsetting extension"), len=6, default="*22"),
 			VarType("toggle",   title=_("Set function toggleable"), type="bool"),
 			VarType("devstateprefix",   title=_("Create Devstate extension. Devstate Prefix:"), len=8, optional=True, default="")
 		       	]
@@ -44,8 +44,20 @@
 					]
 	
 	def row(self):
-		return ("%s / %s" % (self.set,self.ext),"%s %s" % (self.shortName, self.type), self.pbx)
+		return ("%s / %s" % (self.set,self.unset),"%s %s" % (self.shortName, self.type), self.pbx)
 
+	def checkConfig(self):
+		import configlets
+		for o in configlets.configlet_tree:
+			if o==self: continue
+			try:
+				if o.ext == self.set:
+					return ("set", _("Extension already in use"))
+				if o.ext == self.unset:
+					return ("unset", _("Extension already in use"))
+			except AttributeError:
+				pass
+
 	def createAsteriskConfig(self):
 		if self.devstateprefix:
 		    needModule("app_devstate")
@@ -56,8 +68,8 @@
 		c.appendExten("_%s" % self.set, "Set(lastnum=${DB(%s_LASTNUM/%s/${CALLERIDNUM})})" % (self.type, self.pbx))
 		c.appendExten("_%s" % self.set, 'GotoIf($["${lastnum}" = ""]?nonumber)')
 		c.appendExten("_%s" % self.set, "Goto(%s,%s${lastnum},1)" % (self.pbx, self.set))
-		c.appendExten("_%s" % self.set, "Goto(%s,%s,1)" % (self.pbx, self.ext), label="nonumber")
-		c.appendExten("_%s" % self.set, "Goto(%s,%s,1)" % (self.pbx, self.ext), label="switchoff")
+		c.appendExten("_%s" % self.set, "Goto(%s,%s,1)" % (self.pbx, self.unset), label="nonumber")
+		c.appendExten("_%s" % self.set, "Goto(%s,%s,1)" % (self.pbx, self.unset), label="switchoff")
 		c.appendExten("_%s." % self.set, "Answer()")
 		if self.toggle:
 			c.appendExten("_%s." % self.set, "Set(testcf=${DB(%s/%s/${CALLERIDNUM})})" % (self.type, self.pbx))
@@ -74,12 +86,12 @@
 			c.appendExten("_%s." % self.set, "Playback(call-fwd-on-busy)")
 		c.appendExten("_%s." % self.set, "Wait(1)")
 		c.appendExten("_%s." % self.set, "Hangup")
-		c.appendExten("_%s." % self.set, "Goto(%s,%s,1)" % (self.pbx, self.ext), label="switchoff")
+		c.appendExten("_%s." % self.set, "Goto(%s,%s,1)" % (self.pbx, self.unset), label="switchoff")
 
-		c.appendExten("%s" % self.ext, "Answer()")
-		c.appendExten("%s" % self.ext, "DBdel(%s/%s/${CALLERIDNUM})" % (self.type, self.pbx))
+		c.appendExten("%s" % self.unset, "Answer()")
+		c.appendExten("%s" % self.unset, "DBdel(%s/%s/${CALLERIDNUM})" % (self.type, self.pbx))
 		if self.devstateprefix:
-			c.appendExten("%s" % self.ext, "Devstate(%s_%s_${CALLERIDNUM},0)" % (self.type.lower(), self.pbx))
-		c.appendExten("%s" % self.ext, "Playback(call-fwd-cancelled)")
-		c.appendExten("%s" % self.ext, "Wait(1)")
-		c.appendExten("%s" % self.ext, "Hangup")
+			c.appendExten("%s" % self.unset, "Devstate(%s_%s_${CALLERIDNUM},0)" % (self.type.lower(), self.pbx))
+		c.appendExten("%s" % self.unset, "Playback(call-fwd-cancelled)")
+		c.appendExten("%s" % self.unset, "Wait(1)")
+		c.appendExten("%s" % self.unset, "Hangup")

Modified: trunk/cfg_app_dnd.py
===================================================================
--- trunk/cfg_app_dnd.py	2007-04-10 23:59:34 UTC (rev 650)
+++ trunk/cfg_app_dnd.py	2007-04-11 20:37:40 UTC (rev 651)
@@ -46,8 +46,10 @@
 		for o in configlets.configlet_tree:
 			if o==self: continue
 			try:
-				if o.ext == self.set or o.ext == self.unset:
-					return ("ext", _("Extension already in use"))
+				if o.ext == self.set:
+					return ("set", _("Extension already in use"))
+				if o.ext == self.unset:
+					return ("unset", _("Extension already in use"))
 			except AttributeError:
 				pass
 

Modified: trunk/cfg_app_quickdial_global.py
===================================================================
--- trunk/cfg_app_quickdial_global.py	2007-04-10 23:59:34 UTC (rev 650)
+++ trunk/cfg_app_quickdial_global.py	2007-04-11 20:37:40 UTC (rev 651)
@@ -32,7 +32,7 @@
 				VarType("pbx",    title=_("Virtual PBX"), type="choice", options=getChoice("CfgOptPBX")),
 				VarType("pin", title=_("Password"), len=20, optional=True),
 				VarType("set",      title=_("Setting prefix"), len=6, default="*9"),
-				VarType("ext",   title=_("Unsetting prefix"), len=6, default="#9#")
+				VarType("unset",   title=_("Unsetting prefix"), len=6, default="#9#")
 		       ]
 		self.dependencies = [ DepType("pbx", 
 					type="hard",
@@ -40,8 +40,20 @@
 					]
 	
 	def row(self):
-		return ("%s / %s" % (self.set,self.ext),self.shortName,self.pbx)
+		return ("%s / %s" % (self.set,self.unset),self.shortName,self.pbx)
 
+	def checkConfig(self):
+		import configlets
+		for o in configlets.configlet_tree:
+			if o==self: continue
+			try:
+				if o.ext == self.set:
+					return ("set", _("Extension already in use"))
+				if o.ext == self.unset:
+					return ("unset", _("Extension already in use"))
+			except AttributeError:
+				pass
+
 	def createAsteriskConfig(self):
 		c = AstConf("extensions.conf")
 		c.setSection(self.pbx)
@@ -50,5 +62,5 @@
 			c.appendExten("_%sXX*X." % self.set, "Authenticate(%s)" % self.pin)
 		c.appendExten("_%sXX*X." % self.set, "Set(DB(QUICKDIALLIST/GLOBAL/${EXTEN:%d:2})=${EXTEN:%d})" % (len(self.set),len(self.set)+3))
 		c.appendExten("_%sXX*X." % self.set, "Hangup")
-		c.appendExten("_%sXX" % self.ext, "DBdel(QUICKDIALLIST/GLOBAL/${EXTEN:%d})" % len(self.ext))
-		c.appendExten("_%sXX" % self.ext, "Hangup")
+		c.appendExten("_%sXX" % self.unset, "DBdel(QUICKDIALLIST/GLOBAL/${EXTEN:%d})" % len(self.unset))
+		c.appendExten("_%sXX" % self.unset, "Hangup")

Modified: trunk/cfg_app_quickdial_phone.py
===================================================================
--- trunk/cfg_app_quickdial_phone.py	2007-04-10 23:59:34 UTC (rev 650)
+++ trunk/cfg_app_quickdial_phone.py	2007-04-11 20:37:40 UTC (rev 651)
@@ -31,7 +31,7 @@
 		self.variables   = [
 			VarType("pbx",    title=_("Virtual PBX"), type="choice", options=getChoice("CfgOptPBX")),
 			VarType("set",      title=_("Setting prefix"), len=6, default="*7"),
-			VarType("ext",   title=_("Unsetting prefix"), len=6, default="#7#"),
+			VarType("unset",   title=_("Unsetting prefix"), len=6, default="#7#"),
 			VarType("dialprefix",   title=_("Dial prefix"), len=6, default="**"),
 		       ]
 		self.dependencies = [ DepType("pbx", 
@@ -40,12 +40,12 @@
 					]
 	
 	def row(self):
-		return ("%s / %s" % (self.set,self.ext),self.shortName,self.pbx)
+		return ("%s / %s" % (self.set,self.unset),self.shortName,self.pbx)
 
 	def createAsteriskConfig(self):
 		c = AstConf("extensions.conf")
 		c.setSection(self.pbx)
 		c.appendExten("_%sXX*X." % self.set, "Set(DB(QUICKDIALLIST/${CALLERIDNUM}/${EXTEN:%d:2})=${EXTEN:%d})" % (len(self.set),len(self.set)+3))
 		c.appendExten("_%sXX*X." % self.set, "Hangup")
-		c.appendExten("_%sXX" % self.ext, "DBdel(QUICKDIALLIST/${CALLERIDNUM}/${EXTEN:%d})" % len(self.ext))
-		c.appendExten("_%sXX" % self.ext, "Hangup")
+		c.appendExten("_%sXX" % self.unset, "DBdel(QUICKDIALLIST/${CALLERIDNUM}/${EXTEN:%d})" % len(self.unset))
+		c.appendExten("_%sXX" % self.unset, "Hangup")



From dasenjo at mail.berlios.de  Thu Apr 12 03:27:09 2007
From: dasenjo at mail.berlios.de (dasenjo at BerliOS)
Date: Thu, 12 Apr 2007 03:27:09 +0200
Subject: [Destar-dev] r652 - trunk
Message-ID: <200704120127.l3C1R9oK003549@sheep.berlios.de>

Author: dasenjo
Date: 2007-04-12 03:27:07 +0200 (Thu, 12 Apr 2007)
New Revision: 652

Added:
   trunk/cfg_app_agentlogin.py
   trunk/cfg_phone_agent.py
Modified:
   trunk/CHANGELOG.txt
   trunk/configlets.py
Log:
* Added support for queue agents (not just phones) and an agent login extension.



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-11 20:37:40 UTC (rev 651)
+++ trunk/CHANGELOG.txt	2007-04-12 01:27:07 UTC (rev 652)
@@ -1,3 +1,6 @@
+2007-04-11:
+* Added support for queue agents (not just phones) and an agent login extension.
+
 2007-04-10:
 * Added port option in sip trunks
 

Added: trunk/cfg_app_agentlogin.py
===================================================================
--- trunk/cfg_app_agentlogin.py	2007-04-11 20:37:40 UTC (rev 651)
+++ trunk/cfg_app_agentlogin.py	2007-04-12 01:27:07 UTC (rev 652)
@@ -0,0 +1,51 @@
+# -*- coding: utf-8 -*-
+#
+# Copyright (C) 2007 by Diego Andr?s Asenjo
+# 
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+#
+
+
+from configlets import *
+
+class CfgAppAgentLogin(CfgApp):
+
+	shortName   = _("Agent login extension")
+	newObjectTitle  = _("New agent login extension")
+	description = _("""This application allows an agent to log into the system.""")
+	
+	def createVariables(self):
+		self.variables = [
+			VarType("pbx",
+				title=_("Virtual PBX"),
+				type="choice",
+				options=getChoice("CfgOptPBX")),
+
+			VarType("ext",
+				title=_("Extension"),
+				len=6)]
+
+		self.dependencies = [ DepType("pbx", 
+					type="hard",
+					message = _("This is a Dependency")),
+					]
+
+	def createAsteriskConfig(self):
+		needModule("chan_agent")
+	
+		c = AstConf("extensions.conf")
+		c.setSection(self.pbx)
+		c.appendExten(self.ext, "AgentLogin()")
+

Added: trunk/cfg_phone_agent.py
===================================================================
--- trunk/cfg_phone_agent.py	2007-04-11 20:37:40 UTC (rev 651)
+++ trunk/cfg_phone_agent.py	2007-04-12 01:27:07 UTC (rev 652)
@@ -0,0 +1,82 @@
+# -*- coding: utf-8 -*-
+#
+# Copyright (C) 2005 by Holger Schurig,
+# add ons by Michael Bielicki, TAAN Softworks Corp.
+# 
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+#
+
+
+from configlets import *
+
+class CfgPhoneAgent(CfgPhone):
+
+	shortName = _("Agent")
+	newObjectTitle = _("New agent")
+	description = _("This is a queue agent")
+	technology = "AGENT"
+	
+	def createVariables(self):
+		self.variables = [
+			VarType("pbx",    
+				title=_("Virtual PBX"), 
+				type="choice", 
+				options=getChoice("CfgOptPBX")),
+
+			VarType("name",
+				title=_("Name"),
+				len=15),
+
+			VarType("number",
+					title=_("Agent number"),
+					type="int",
+					len=15),
+
+			VarType("secret",
+					title=_("Password"),
+					type="int",
+					len=15),
+					
+			VarType("QueueLab",
+					title=_("Call Queues"),
+					type="label",
+					hide=True),
+			
+			VarType("queues",
+					title=_("Agent of queues:"),
+					type="mchoice",
+					optional=True,
+					options=getChoice("CfgPhoneQueue"),
+					hide=True)]
+					
+		queues = len(configlet_tree.getConfigletsByName('CfgPhoneQueue'))
+		if queues > 0:
+			for v in self.variables:
+				if v.name == "QueueLab" or v.name == "queues":
+					v.hide = False
+
+		self.dependencies = [
+			DepType("pbx", 
+					type="hard",
+					message = _("This is a Dependency")),
+		]
+
+	def createAsteriskConfig(self):
+
+		ag = AstConf("agents.conf")
+		ag.setSection("agents")
+		ag.append("agent=%d,%d,%s" % (self.number, self.secret, self.name))
+
+		self.createQueuesConfig()

Modified: trunk/configlets.py
===================================================================
--- trunk/configlets.py	2007-04-11 20:37:40 UTC (rev 651)
+++ trunk/configlets.py	2007-04-12 01:27:07 UTC (rev 652)
@@ -1053,7 +1053,10 @@
 				c = AstConf("queues.conf")
 				for queue in self.queues.split(','):
 					c.setSection(queue)
-					c.append("member => %s/%s" % (self.technology,self.name))
+					if self.technology == 'SIP' or self.technology == 'IAX':
+						c.append("member => %s/%s" % (self.technology,self.name))
+					if self.technology == 'AGENT':
+						c.append("member => %s/%s" % (self.technology,self.number))
 		except AttributeError:
 			pass
 



From dasenjo at mail.berlios.de  Sat Apr 14 20:34:30 2007
From: dasenjo at mail.berlios.de (dasenjo at BerliOS)
Date: Sat, 14 Apr 2007 20:34:30 +0200
Subject: [Destar-dev] r653 - branches/0.2.X/examples trunk/examples
Message-ID: <200704141834.l3EIYUEH011223@sheep.berlios.de>

Author: dasenjo
Date: 2007-04-14 20:34:30 +0200 (Sat, 14 Apr 2007)
New Revision: 653

Modified:
   branches/0.2.X/examples/destar_cfg.py
   trunk/examples/destar_cfg.py
Log:
* Little bug fix for confno in the example destar_cfg.py file



Modified: branches/0.2.X/examples/destar_cfg.py
===================================================================
--- branches/0.2.X/examples/destar_cfg.py	2007-04-12 01:27:07 UTC (rev 652)
+++ branches/0.2.X/examples/destar_cfg.py	2007-04-14 18:34:30 UTC (rev 653)
@@ -199,7 +199,7 @@
 CfgAppMeetme(
 	pbx      = "pbx1",
 	ext      = "9000",
-	confno   = "9000",
+	confno   = 9000,
 	)
 
 CfgAppDND(

Modified: trunk/examples/destar_cfg.py
===================================================================
--- trunk/examples/destar_cfg.py	2007-04-12 01:27:07 UTC (rev 652)
+++ trunk/examples/destar_cfg.py	2007-04-14 18:34:30 UTC (rev 653)
@@ -199,7 +199,7 @@
 CfgAppMeetme(
 	pbx      = "pbx1",
 	ext      = "9000",
-	confno   = "9000",
+	confno   = 9000,
 	)
 
 CfgAppDND(



From dasenjo at mail.berlios.de  Tue Apr 17 02:08:09 2007
From: dasenjo at mail.berlios.de (dasenjo at BerliOS)
Date: Tue, 17 Apr 2007 02:08:09 +0200
Subject: [Destar-dev] r654 - branches/0.2.X trunk
Message-ID: <200704170008.l3H089U0031172@sheep.berlios.de>

Author: dasenjo
Date: 2007-04-17 02:08:07 +0200 (Tue, 17 Apr 2007)
New Revision: 654

Modified:
   branches/0.2.X/CHANGELOG.txt
   branches/0.2.X/ConfigHelper.ptl
   trunk/CHANGELOG.txt
   trunk/ConfigHelper.ptl
Log:
* Fixed Bug #8932 (CfgOptSingle configlets could not be deleted)



Modified: branches/0.2.X/CHANGELOG.txt
===================================================================
--- branches/0.2.X/CHANGELOG.txt	2007-04-14 18:34:30 UTC (rev 653)
+++ branches/0.2.X/CHANGELOG.txt	2007-04-17 00:08:07 UTC (rev 654)
@@ -1,3 +1,7 @@
+2001-04-16:
+* Configlets that extends from CfgOptSingle now can be deleted.
+* Fixed Bug #8932
+
 2007-04-10:
 * Added port option in sip trunks
 

Modified: branches/0.2.X/ConfigHelper.ptl
===================================================================
--- branches/0.2.X/ConfigHelper.ptl	2007-04-14 18:34:30 UTC (rev 653)
+++ branches/0.2.X/ConfigHelper.ptl	2007-04-17 00:08:07 UTC (rev 654)
@@ -320,7 +320,7 @@
 		else:
 			form.add(StringWidget,   v.name, "Unknown type %s" % v.type)
 	
-	if new or not obj.isAddable():
+	if new:
 		txt_submit = _("Submit")
 		txt_delete = ""
 	else:

Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-14 18:34:30 UTC (rev 653)
+++ trunk/CHANGELOG.txt	2007-04-17 00:08:07 UTC (rev 654)
@@ -1,3 +1,7 @@
+2007-04-16:
+* Configlets that extends from CfgOptSingle now can be deleted.
+* Fixed Bug #8932
+
 2007-04-11:
 * Added support for queue agents (not just phones) and an agent login extension.
 

Modified: trunk/ConfigHelper.ptl
===================================================================
--- trunk/ConfigHelper.ptl	2007-04-14 18:34:30 UTC (rev 653)
+++ trunk/ConfigHelper.ptl	2007-04-17 00:08:07 UTC (rev 654)
@@ -370,7 +370,7 @@
 		else:
 			form.add(StringWidget,   v.name, "Unknown type %s" % v.type)
 	
-	if new or not obj.isAddable():
+	if new:
 		txt_submit = _("Submit")
 		txt_delete = ""
 	else:



From admin at berlios.de  Tue Apr 17 02:07:38 2007
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 16 Apr 2007 19:07:38 -0500 (COT)
Subject: [Destar-dev] [Bug #8932] Single options
Message-ID: <200704170007.l3H07cjU017019@unicorn.berlios.de>

Bug #8932, was updated on 2006-Sep-28 19:05
Here is a current snapshot of the bug.

Project: DeStar
Category: None
Status: Closed
Resolution: None
Bug Group: None
Priority: 5
Submitted by: dasenjo
Assigned to : none
Summary: Single options

Details: The options of the CfgOptSingle class can't be deleted after created.

Follow-Ups:

Date: 2007-Apr-16 19:07
By: dasenjo

Comment:
Closed on svn revision 654. 
-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=8932&group_id=2112


From admin at berlios.de  Tue Apr 17 02:09:47 2007
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 16 Apr 2007 19:09:47 -0500 (COT)
Subject: [Destar-dev] [Bug #10641] Unicode should be turned off
Message-ID: <200704170009.l3H09lv3017995@unicorn.berlios.de>

Bug #10641, was updated on 2007-Mar-14 20:59
Here is a current snapshot of the bug.

Project: DeStar
Category: None
Status: Closed
Resolution: None
Bug Group: None
Priority: 5
Submitted by: imesper
Assigned to : none
Summary: Unicode should be turned off

Details: we should not use unicode, we must change the charset to utf-8, so we will be able to have accent in widgets, the branch 0.2.x show the page in utf-8 not in iso-8859-1 as trunk does

Follow-Ups:

Date: 2007-Apr-16 19:09
By: dasenjo

Comment:
The utf-8 transitions seems now complete. Maybe we need more revision, but the basic part is now ready and working.
-------------------------------------------------------

Date: 2007-Mar-16 09:53
By: imesper

Comment:
It was solved in revision 637, without the need to turn unicode off
-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=10641&group_id=2112


From admin at berlios.de  Tue Apr 17 02:14:37 2007
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 16 Apr 2007 19:14:37 -0500 (COT)
Subject: [Destar-dev] [Bug #9633] Queue not working without music on hold
Message-ID: <200704170014.l3H0EbiX020304@unicorn.berlios.de>

Bug #9633, was updated on 2006-Dec-05 16:39
Here is a current snapshot of the bug.

Project: DeStar
Category: None
Status: Closed
Resolution: None
Bug Group: None
Priority: 7
Submitted by: dasenjo
Assigned to : none
Summary: Queue not working without music on hold

Details: When a queue is confiured without a music on hold class and without the "ring instead" option, destar generate a single Answer line that does not have any utility.

Follow-Ups:

Date: 2007-Apr-16 19:14
By: dasenjo

Comment:
Tests completed. Queues are working well.
-------------------------------------------------------

Date: 2006-Dec-07 15:05
By: dasenjo

Comment:
Partial fix in rev 539 from svn. Needs more test.
-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=9633&group_id=2112


From admin at berlios.de  Tue Apr 17 02:19:01 2007
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 16 Apr 2007 19:19:01 -0500 (COT)
Subject: [Destar-dev] [Bug #10709] Manager access logged in twice
Message-ID: <200704170019.l3H0J14J022146@unicorn.berlios.de>

Bug #10709, was updated on 2007-Mar-22 15:36
Here is a current snapshot of the bug.

Project: DeStar
Category: None
Status: Closed
Resolution: None
Bug Group: None
Priority: 7
Submitted by: dasenjo
Assigned to : none
Summary: Manager access logged in twice

Details: After installing and running destar for the first time with the default destar_cfg.py the destarman manager access is logged twice in asterisk:

macondo*CLI> show manager connected
  Username         IP Address
  destarman        127.0.0.1
  destarman        127.0.0.1
macondo*CLI>


Follow-Ups:

Date: 2007-Apr-16 19:18
By: dasenjo

Comment:
There is a manager login for destar and one for the asternic panel, so this behavior is normal.
-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=10709&group_id=2112


From admin at berlios.de  Tue Apr 17 02:37:52 2007
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 16 Apr 2007 19:37:52 -0500 (COT)
Subject: [Destar-dev] [Bug #10100] optional is not working
Message-ID: <200704170037.l3H0bqcF000405@unicorn.berlios.de>

Bug #10100, was updated on 2007-Jan-23 01:49
Here is a current snapshot of the bug.

Project: DeStar
Category: None
Status: Open
Resolution: None
Bug Group: None
Priority: 7
Submitted by: dasenjo
Assigned to : none
Summary: optional is not working

Details: In some configlet variables the optional=True param is not working, e.g. cfg_opt_sip_network.py. Check out the asterisk (requied star) in the web (string) widget.

Follow-Ups:

Date: 2007-Apr-16 19:37
By: dasenjo

Comment:
This bug is fixed in trunk (Quixote2) but not in th 0.2 branch
-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=10100&group_id=2112


From santiago at mail.berlios.de  Tue Apr 17 05:11:42 2007
From: santiago at mail.berlios.de (santiago at BerliOS)
Date: Tue, 17 Apr 2007 05:11:42 +0200
Subject: [Destar-dev] r655 - in trunk: . po
Message-ID: <200704170311.l3H3BgS0009546@sheep.berlios.de>

Author: santiago
Date: 2007-04-17 05:11:41 +0200 (Tue, 17 Apr 2007)
New Revision: 655

Modified:
   trunk/CHANGELOG.txt
   trunk/po/es.po
Log:
Updated es.po



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-17 00:08:07 UTC (rev 654)
+++ trunk/CHANGELOG.txt	2007-04-17 03:11:41 UTC (rev 655)
@@ -1,6 +1,7 @@
 2007-04-16:
 * Configlets that extends from CfgOptSingle now can be deleted.
 * Fixed Bug #8932
+* Updated es.po
 
 2007-04-11:
 * Added support for queue agents (not just phones) and an agent login extension.

Modified: trunk/po/es.po
===================================================================
--- trunk/po/es.po	2007-04-17 00:08:07 UTC (rev 654)
+++ trunk/po/es.po	2007-04-17 03:11:41 UTC (rev 655)
@@ -8,7 +8,7 @@
 "Project-Id-Version: DeStar 0.2beta\n"
 "Report-Msgid-Bugs-To: \n"
 "POT-Creation-Date: 2006-09-19 16:28-0500\n"
-"PO-Revision-Date: 2006-09-19 16:31-0500\n"
+"PO-Revision-Date: 2007-04-16 22:11-0500\n"
 "Last-Translator: dasenjo <dasenjo at avatar.com.co>\n"
 "Language-Team: Spanish <es at li.org>\n"
 "MIME-Version: 1.0\n"
@@ -55,7 +55,7 @@
 
 #: cdrutils.py:46 page_admin_cdr.ptl:77 page_admin_cdr.ptl:249
 msgid "Cost_per_Minute"
-msgstr "Costo_por_Minuto"
+msgstr "Costo_por_minuto"
 
 #: cfg_app_callfw.py:26 ../cfg_app_callfw.py:26
 msgid "Call forwarding"
@@ -98,7 +98,7 @@
 
 #: cfg_app_conference.py:26 ../cfg_app_conference.py:26
 msgid "Conference room"
-msgstr "Sala de Conferencias"
+msgstr "Sala de conferencias"
 
 #: cfg_app_conference.py:27 cfg_app_directory.py:28 cfg_app_echo.py:29
 #: cfg_app_meetme.py:27 cfg_app_milliwatt.py:29 cfg_app_music.py:28
@@ -132,7 +132,7 @@
 #: cfg_app_conference.py:28 cfg_app_meetme.py:28 ../cfg_app_conference.py:33
 #: ../cfg_app_meetme.py:32
 msgid "Conference number"
-msgstr "N?mero de Conferencia"
+msgstr "N?mero de conferencia"
 
 #: cfg_app_directory.py:26 cfg_opt_music.py:29 ../cfg_app_directory.py:26
 #: ../cfg_opt_music.py:32
@@ -145,7 +145,7 @@
 
 #: cfg_app_dnd.py:26 ../cfg_app_dnd.py:26
 msgid "Set/Unset DND"
-msgstr "Habilitar/Deshabilitar No Molestar"
+msgstr "Habilitar/Deshabilitar no nolestar"
 
 #: cfg_app_dnd.py:27 ../cfg_app_dnd.py:28
 msgid "Extensions to set/unset 'Do Not Disturb'."
@@ -162,7 +162,7 @@
 
 #: cfg_app_echo.py:26 ../cfg_app_echo.py:26
 msgid "Echo test"
-msgstr "Prueba de Eco"
+msgstr "Prueba de eco"
 
 #: cfg_app_echo.py:27 ../cfg_app_echo.py:28
 msgid ""
@@ -195,7 +195,7 @@
 #: ../page_admin_panel.ptl:27 ../cfg_phone_sip.py:97 ../cfg_phone_queue.py:153
 #: ../cfg_trunk_sip.py:68 ../page_admin_panel.ptl:26
 msgid "Operator Panel"
-msgstr "P?nel de Operadora"
+msgstr "P?nel de operadora"
 
 #: cfg_app_meetme.py:32 cfg_trunk_iax.py:48 cfg_trunk_sip.py:40
 #: cfg_trunk_zappri.py:46 cfg_trunk_zap.py:36 ../cfg_app_meetme.py:36
@@ -226,7 +226,7 @@
 #: ../cfg_app_music.py:33 ../cfg_ivr_autoatt.py:46 ../cfg_phone_queue.py:53
 #: ../cfg_ivr_autoatt.py:61
 msgid "Music-on-hold class"
-msgstr "Tipo de M?sica en Espera"
+msgstr "Tipo de m?sica en espera"
 
 #: cfg_app_parking.py:26 ../cfg_app_parking.py:26
 msgid "Park calls"
@@ -317,7 +317,7 @@
 
 #: cfg_app_saytime.py:31 ../cfg_app_saytime.py:35
 msgid "Date and Time"
-msgstr "Fecha y Hora"
+msgstr "Fecha y hora"
 
 #: cfg_app_voicemail.py:26 ../cfg_app_voicemail.py:26
 msgid "Voicemail dialog"
@@ -422,7 +422,7 @@
 
 #: cfg_ivr_autoatt.py:37 ../cfg_ivr_autoatt.py:56 ../cfg_ivr_autoatt.py:71
 msgid "How many times should it be played?"
-msgstr "Cuantas veces debe ser reproducido?"
+msgstr "?Cu?ntas veces debe ser reproducido?"
 
 #: cfg_ivr_autoatt.py:38 ../cfg_ivr_autoatt.py:62 ../cfg_ivr_autoatt.py:77
 msgid "Pause between each playback"
@@ -537,7 +537,7 @@
 #: cfg_opt_loadmodule.py:26 ../cfg_opt_loadmodule.py:26
 #: ../cfg_opt_loadmodule.py:27
 msgid "Load module"
-msgstr "Cargar M?dulo"
+msgstr "Cargar m?dulo"
 
 #: cfg_opt_loadmodule.py:27 ../cfg_opt_loadmodule.py:28
 msgid "Module to load"
@@ -577,7 +577,7 @@
 
 #: cfg_opt_logger.py:42 ../cfg_opt_logger.py:44
 msgid "Console output"
-msgstr "Salida de Consola"
+msgstr "Salida de consola"
 
 #: cfg_opt_logger.py:48 ../cfg_opt_logger.py:50
 msgid "Output in /var/log/asterisk/messages"
@@ -594,7 +594,7 @@
 #: cfg_opt_manager.py:27 page_config.ptl:80 ../cfg_opt_manager.py:26
 #: ../page_config.ptl:80
 msgid "Management API access"
-msgstr "Acceso del API de Gesti?n"
+msgstr "Acceso del API de gesti?n"
 
 #: cfg_opt_manager.py:29 ../cfg_opt_manager.py:32
 msgid "Secret"
@@ -622,7 +622,7 @@
 
 #: cfg_opt_oppanel.py:28 ../cfg_opt_oppanel.py:29
 msgid "Configure Asternic Flash Operator Panel"
-msgstr "Configurar el P?nel de Operadora Asternic"
+msgstr "Configurar el p?nel de operadora Asternic"
 
 #: cfg_opt_oppanel.py:33 ../cfg_opt_oppanel.py:35
 msgid "FQDN/IP to access the panel via web"
@@ -785,7 +785,7 @@
 #: cfg_opt_settings.py:318 ../cfg_opt_settings.py:321
 msgid "The country is used for generating dialtone, ringtone, busytone etc"
 msgstr ""
-"El Pa?s se utiliza para generar el tono de marcado, timbre, tono de "
+"El pa?s se utiliza para generar el tono de marcado, timbre, tono de "
 "invitaci?n a marcar, etc."
 
 #: cfg_opt_settings.py:322 ../cfg_opt_settings.py:325
@@ -804,17 +804,17 @@
 #: cfg_opt_sip_audio.py:29 ../cfg_opt_sip_audio.py:32
 #: ../cfg_opt_sip_audio.py:34
 msgid "Codecs to use"
-msgstr "Codecs a usar"
+msgstr "C?decs a usar"
 
 #: cfg_opt_sip_audio.py:30 ../cfg_opt_sip_audio.py:33
 #: ../cfg_opt_sip_audio.py:35
 msgid "Allow alaw codec"
-msgstr "Permitir c?dec Ley A"
+msgstr "Permitir c?dec ley A"
 
 #: cfg_opt_sip_audio.py:31 ../cfg_opt_sip_audio.py:34
 #: ../cfg_opt_sip_audio.py:36
 msgid "Allow ulaw codec"
-msgstr "Permitir c?dec Ley U"
+msgstr "Permitir c?dec ley U"
 
 #: cfg_opt_sip_audio.py:32 ../cfg_opt_sip_audio.py:35
 #: ../cfg_opt_sip_audio.py:37
@@ -876,7 +876,7 @@
 
 #: cfg_opt_user.py:32 ../cfg_opt_user.py:34
 msgid "Associated phone"
-msgstr "Tel?fono Asociado"
+msgstr "Tel?fono asociado"
 
 #: cfg_opt_user.py:35 page_user_info.ptl:49 page_user.ptl:46
 #: ../cfg_opt_user.py:38 ../page_user_info.ptl:49 ../page_user.ptl:46
@@ -936,7 +936,7 @@
 
 #: cfg_opt_voicemail.py:35 ../cfg_opt_voicemail.py:38
 msgid "Playback settings"
-msgstr "Configuraci?n de Reproducci?n"
+msgstr "Configuraci?n de reproducci?n"
 
 #: cfg_opt_voicemail.py:36 ../cfg_opt_voicemail.py:39
 msgid "Max number of failed login attempts"
@@ -949,7 +949,7 @@
 #: cfg_opt_zap_audio.py:26 ../cfg_opt_zap_audio.py:26
 #: ../cfg_opt_zap_audio.py:27
 msgid "Zaptel Audio Options"
-msgstr "Opciones de audio de Zaptel"
+msgstr "Opciones de audio de zaptel"
 
 #: cfg_opt_zap_audio.py:28 ../cfg_opt_zap_audio.py:31
 msgid "Be sloppy when detecting DTMF"
@@ -970,7 +970,7 @@
 #: cfg_opt_zap_phone.py:26 ../cfg_opt_zap_phone.py:26
 #: ../cfg_opt_zap_phone.py:27
 msgid "Zaptel Phone Options"
-msgstr "Opciones de tel?fono Zaptel"
+msgstr "Opciones de tel?fono zaptel"
 
 #: cfg_opt_zap_phone.py:28 ../cfg_opt_zap_phone.py:31
 msgid "Use ADSI for menu phones"
@@ -1003,11 +1003,11 @@
 
 #: cfg_opt_zappri.py:28 ../cfg_opt_zappri.py:28 ../cfg_opt_zappri.py:29
 msgid "Zaptel configuration for PRI"
-msgstr "Configuraci?n de Zaptel para PRI"
+msgstr "Configuraci?n de zaptel para PRI"
 
 #: cfg_opt_zappri.py:31 ../cfg_opt_zappri.py:33
 msgid "Zaptel span"
-msgstr "Span Zaptel"
+msgstr "Span zaptel"
 
 #: cfg_opt_zappri.py:31 ../cfg_opt_zappri.py:33
 msgid "i.e. 1 if 1st card"
@@ -1015,7 +1015,7 @@
 
 #: cfg_opt_zappri.py:32 ../cfg_opt_zappri.py:34
 msgid "Zaptel timing parameter"
-msgstr "Par?metro de temporizaci?n de Zaptel"
+msgstr "Par?metro de temporizaci?n de zaptel"
 
 #: cfg_opt_zappri.py:32 ../cfg_opt_zappri.py:34
 msgid "Read zaptel documentation"
@@ -1023,7 +1023,7 @@
 
 #: cfg_opt_zappri.py:33 ../cfg_opt_zappri.py:35
 msgid "Line Build Out (dB)"
-msgstr "LBO (Extensi?n de L?nea) en decibeles"
+msgstr "LBO (Extensi?n de l?nea) en decibeles"
 
 #: cfg_opt_zappri.py:33 ../cfg_opt_zappri.py:35
 msgid ""
@@ -1122,7 +1122,7 @@
 #: cfg_opt_zap_trunk.py:26 ../cfg_opt_zap_trunk.py:26
 #: ../cfg_opt_zap_trunk.py:27
 msgid "Zaptel Trunk Options"
-msgstr "Opciones de troncal Zaptel"
+msgstr "Opciones de troncal zaptel"
 
 #: cfg_opt_zap_trunk.py:28 ../cfg_opt_zap_trunk.py:31
 msgid "Try to detect busy signal to detect if remove site hung up"
@@ -1437,7 +1437,7 @@
 #: cfg_phone_sip.py:37 ../cfg_phone_epygi.py:66 ../cfg_phone_sip.py:66
 #: ../cfg_phone_sip.py:67
 msgid "In Band (only with ulaw/alaw)"
-msgstr "En Banda (s?lo con Ley U/Ley A)"
+msgstr "En banda (s?lo con Ley U/Ley A)"
 
 #: cfg_phone_sip.py:38 ../cfg_phone_epygi.py:67 ../cfg_phone_sip.py:67
 #: ../cfg_phone_sip.py:68
@@ -1461,7 +1461,7 @@
 #: cfg_phone_zap.py:30 cfg_trunk_zap.py:30 ../cfg_phone_zap.py:43
 #: ../cfg_trunk_zappbx.py:34 ../cfg_trunk_zap.py:33
 msgid "Zaptel channel number"
-msgstr "N?mero del canal Zaptel"
+msgstr "N?mero del canal zaptel"
 
 #: cfg_phone_zap.py:31 cfg_trunk_zappri.py:31 cfg_trunk_zap.py:31
 #: ../cfg_phone_zap.py:48 ../cfg_trunk_zappbx.py:35 ../cfg_trunk_zappri.py:35
@@ -1485,7 +1485,7 @@
 #: ../cfg_trunk_capimsn.py:34 ../cfg_trunk_capi.py:37
 #: ../cfg_trunk_zaphfc.py:37
 msgid "Subscriber number"
-msgstr "N?mero de Suscriptor"
+msgstr "N?mero de suscriptor"
 
 #: cfg_trunk_capimsn.py:70 ../cfg_trunk_capimsn.py:68
 #: ../cfg_trunk_capimsn.py:67
@@ -1601,7 +1601,7 @@
 
 #: cfg_trunk_iax.py:41 ../cfg_trunk_iax.py:43
 msgid "For 'Plain' or 'MD5' only"
-msgstr "S?lo para \"Texto plano\" o \"RSA\""
+msgstr "S?lo para \"texto plano\" o \"RSA\""
 
 #: cfg_trunk_iax.py:42 ../cfg_trunk_iax.py:44
 msgid "Public key from remote server"
@@ -1633,7 +1633,7 @@
 
 #: cfg_trunk_iaxtel.py:26 ../cfg_trunk_iaxtel.py:26
 msgid "VOIP-Provider Iaxtel"
-msgstr "IAXTEL del Proveedor de VoIP"
+msgstr "IAXTEL del proveedor de VoIP"
 
 #: cfg_trunk_iaxtel.py:28 ../cfg_trunk_iaxtel.py:29
 msgid ""
@@ -1674,7 +1674,7 @@
 
 #: cfg_trunk_sip.py:33 ../cfg_trunk_sip.py:36 ../cfg_trunk_sip.py:40
 msgid "SIP username"
-msgstr "Nombre de Usuario SIP"
+msgstr "Nombre de usuario SIP"
 
 #: cfg_trunk_sip.py:34 ../cfg_trunk_sip.py:37 ../cfg_trunk_sip.py:44
 msgid "SIP password"
@@ -1786,7 +1786,7 @@
 #: configlets.py:600 ../configlets.py:800 ../configlets.py:804
 #: ../configlets.py:824 ../configlets.py:825 ../configlets.py:841
 msgid "Dial Command"
-msgstr "Comando Marcar"
+msgstr "Comando marcar"
 
 #: configlets.py:628 ../configlets.py:828 ../configlets.py:832
 #: ../configlets.py:852 ../configlets.py:853 ../configlets.py:869
@@ -1812,7 +1812,7 @@
 
 #: panelutils.py:98 ../panelutils.py:98
 msgid "Meetme"
-msgstr "Sala de Conferencia"
+msgstr "Sala de conferencia"
 
 #: panelutils.py:102 ../panelutils.py:102
 msgid "PARK"
@@ -1903,7 +1903,7 @@
 
 #: Missing.ptl:41
 msgid "This page is on my TODO list :-)"
-msgstr "Est? p?gina est? en desarrollo"
+msgstr "Esta p?gina est? en desarrollo"
 
 #: Options.ptl:30 page_config_options.ptl:26 page_config.ptl:68
 #: page_config.ptl:80 ../page_config_options.ptl:26 ../page_config.ptl:68
@@ -2102,7 +2102,7 @@
 #: page_admin_panel.ptl:28 ../page_admin_panel.ptl:28
 #: ../page_admin_panel.ptl:27
 msgid "Asternic Flash Operator Panel"
-msgstr "P?nel de Operadora Flash Asternic"
+msgstr "P?nel de operadora flash Asternic"
 
 #: page_admin_panel.ptl:43 ../page_admin_panel.ptl:43
 #: ../page_admin_panel.ptl:42
@@ -2200,7 +2200,7 @@
 
 #: page_config_ivrs.ptl:28 ../page_config_ivrs.ptl:28
 msgid "Interactive Voice Response menus for the PBX."
-msgstr "Men?s de Respuesta de Voz Interactiva para la PBX"
+msgstr "Men?s de respuesta de voz Interactiva para la PBX"
 
 #: page_config_options.ptl:27 ../page_config_options.ptl:27
 msgid "DeStar and Asterisk options and parameters"
@@ -2295,7 +2295,7 @@
 "integrated whit the panel."
 msgstr ""
 "Debe habilitar los permisos de escritura al directorio %s. Sin la "
-"posibilidad de editar los archivos de configuraci?n del Panel de Operadora "
+"posibilidad de editar los archivos de configuraci?n del p?nel de operadora "
 "Flash de Asternic, DeStar no podr? estar integrado con el panel."
 
 #: page_config.ptl:116 ../page_config.ptl:116 ../page_config.ptl:120
@@ -2316,7 +2316,7 @@
 
 #: page_config_reload.ptl:27 ../page_admin_reload.ptl:27
 msgid "Apply Changes"
-msgstr "Aplicar Cambios"
+msgstr "Aplicar cambios"
 
 #: page_config_reload.ptl:28 ../page_admin_reload.ptl:28
 msgid "Reload Asterisk/DeStar PBX"
@@ -2344,7 +2344,7 @@
 
 #: page_config_users.ptl:27 ../page_config_users.ptl:27
 msgid "Users and Mailboxes"
-msgstr "Usuarios y Buz?nes de mensajes"
+msgstr "Usuarios y buz?nes de mensajes"
 
 #: page_config_viewconf.ptl:29 ../page_admin_viewconf.ptl:29
 msgid "View Configuration"
@@ -2393,7 +2393,7 @@
 
 #: page_login.ptl:27 UserPage.ptl:111 ../page_login.ptl:26
 msgid "Login"
-msgstr "Inicio de Sesi?n"
+msgstr "Inicio de sesi?n"
 
 #: page_login.ptl:28 ../page_login.ptl:27
 msgid "Login into DeStar"
@@ -2414,7 +2414,7 @@
 #: page_logout.ptl:25 Templates.ptl:227 ../page_logout.ptl:25
 #: ../Templates.ptl:259 ../Templates.ptl:260
 msgid "Logout"
-msgstr "Cerrar Sesi?n"
+msgstr "Cerrar sesi?n"
 
 #: page_logout.ptl:26 ../page_logout.ptl:26
 msgid "Logout and become a guest user"
@@ -2426,11 +2426,11 @@
 
 #: page_main.ptl:29 ../page_main.ptl:29
 msgid "DeStar main page"
-msgstr "P?gina Principal de Destar"
+msgstr "P?gina principal de Destar"
 
 #: page_main.ptl:137 ../page_main.ptl:137
 msgid "Access Denied"
-msgstr "Acceso Denegado"
+msgstr "Acceso denegado"
 
 #: page_main.ptl:139 ../page_main.ptl:139
 msgid "You don't have access to this page."
@@ -2438,7 +2438,7 @@
 
 #: page_user_info.ptl:26 ../page_user_info.ptl:26
 msgid "User Info"
-msgstr "Informaci?n del Usuario"
+msgstr "Informaci?n del usuario"
 
 #: page_user_info.ptl:27 ../page_user_info.ptl:27
 msgid "Your access rights in DeStar"
@@ -2535,7 +2535,7 @@
 #: page_user_settings.ptl:56 UserUI.ptl:43 ../page_user_settings.ptl:56
 #: ../page_user_settings.ptl:57
 msgid "Enable 'do not disturb'"
-msgstr "Habilitar 'no molestar"
+msgstr "Habilitar 'no molestar'"
 
 #: page_user_settings.ptl:57 UserUI.ptl:44 ../page_user_settings.ptl:57
 #: ../page_user_settings.ptl:58
@@ -2574,7 +2574,7 @@
 
 #: page_user_state.ptl:27 ../page_user_state.ptl:27
 msgid "Phone State"
-msgstr "Estado del Tel?fono"
+msgstr "Estado del tel?fono"
 
 #: page_user_state.ptl:28 ../page_user_state.ptl:28
 msgid "Status of your phone"
@@ -2586,11 +2586,11 @@
 
 #: page_user_state.ptl:57 UserUI.ptl:84 ../page_user_state.ptl:57
 msgid "Last updated"
-msgstr "?ltima Actualizaci?n"
+msgstr "?ltima actualizaci?n"
 
 #: page_user_state.ptl:69 UserUI.ptl:96 ../page_user_state.ptl:69
 msgid "Registration status"
-msgstr "Estado de Registro"
+msgstr "Estado de registro"
 
 #: page_user_state.ptl:69 UserUI.ptl:96 ../page_user_state.ptl:69
 msgid "PeerStatus"
@@ -2598,7 +2598,7 @@
 
 #: page_user_state.ptl:75 UserUI.ptl:102 ../page_user_state.ptl:75
 msgid "Channel ID"
-msgstr "Identificaci?n del Canal"
+msgstr "Identificaci?n del canal"
 
 #: page_user_state.ptl:75 UserUI.ptl:102 ../page_user_state.ptl:75
 msgid "Channel"
@@ -2656,11 +2656,11 @@
 
 #: UserPage.ptl:33
 msgid "User info"
-msgstr "Informaci?n del Usuario"
+msgstr "Informaci?n del usuario"
 
 #: UserPage.ptl:38
 msgid "Phone state"
-msgstr "Estado del Tel?fono"
+msgstr "Estado del tel?fono"
 
 #: UserPage.ptl:40 UserPage.ptl:68
 msgid "Phone settings"
@@ -2672,7 +2672,7 @@
 
 #: UserPage.ptl:83
 msgid "User functions"
-msgstr "Funciones del Usuario"
+msgstr "Funciones del usuario"
 
 #: UserPage.ptl:85
 msgid "This menu will contain all sorts of phone user specific stuff:"
@@ -2807,7 +2807,7 @@
 
 #: ../cfg_app_echo.py:27
 msgid "New Echo test extension"
-msgstr "Nueva extensi?n de prueba de Eco"
+msgstr "Nueva extensi?n de prueba de eco"
 
 #: ../cfg_app_meetme.py:27
 msgid "New meeting room"
@@ -2934,7 +2934,7 @@
 
 #: ../cfg_opt_did.py:27
 msgid "New direct inward dialing (DID) number"
-msgstr "Nuevo n?mero MDE (Marcaci?n Directa a Extensiones)"
+msgstr "Nuevo n?mero MDE (Marcaci?n directa a extensiones)"
 
 #: ../cfg_opt_did.py:28
 msgid ""
@@ -2986,7 +2986,7 @@
 
 #: ../cfg_opt_sip_network.py:36
 msgid "Force external ip/internel network?"
-msgstr "Forzar red ip/internet externa?"
+msgstr "?Forzar red ip/internet externa?"
 
 #: ../cfg_opt_sip_network.py:37
 msgid "External ip"
@@ -3059,7 +3059,7 @@
 "Estimado ${VM_NAME}:\\n\\n\\tqueremos anunciarle que le fue dejado un "
 "mensaje de duraci?n: ${VM_DUR} y n?mero: ${VM_MSGNUM}\\n\\ten el buz?n "
 "${VM_MAILBOX} de parte de ${VM_CALLERID}, en la fecha: ${VM_DATE}, de forma "
-"que usted podr?\\n\\trevisarlo.cuando tenga la oportunidad. Gracias!\\n\\n\\t"
+"que usted podr?\\n\\trevisarlo.cuando tenga la oportunidad. ?Gracias!\\n\\n\\t"
 "\\t\\t--PBX Asterisk/Destar."
 
 #: ../cfg_opt_voicemail.py:50
@@ -3260,7 +3260,7 @@
 
 #: ../page_config_dids.ptl:28
 msgid "Direct Inward Dialing."
-msgstr "Marcaci?n Directa a Extensiones"
+msgstr "Marcaci?n directa a extensiones"
 
 #: ../page_owner_cdr.ptl:38
 msgid "Call Details For Virtual PBX"
@@ -3297,13 +3297,13 @@
 #: ../page_owner_cdr.ptl:264 ../page_stats_cdr.ptl:267
 #: ../page_stats_cdr.ptl:268
 msgid "Asc. Order"
-msgstr "Orden Ascendente"
+msgstr "Orden ascendente"
 
 #: ../page_owner_cdr.ptl:265 ../page_stats_cdr.ptl:268
 #: ../page_owner_cdr.ptl:266 ../page_stats_cdr.ptl:269
 #: ../page_stats_cdr.ptl:270
 msgid "Desc. Order"
-msgstr "Orden Descendente"
+msgstr "Orden descendente"
 
 #: ../page_owner_cdr.ptl:293 ../page_owner_cdr.ptl:295
 #: ../page_stats_cdr.ptl:296 ../page_stats_cdr.ptl:298
@@ -3320,7 +3320,7 @@
 #: ../page_stats_callsstats.ptl:39 ../page_stats_callsstats.ptl:40
 #: ../page_stats_calls.ptl:39 ../page_stats_calls.ptl:40
 msgid "Calls Statistics"
-msgstr "Estad?sticas de Llamadas"
+msgstr "Estad?sticas de llamadas"
 
 #: ../page_stats_callsstats.ptl:55 ../page_stats_calls.ptl:55
 msgid "Day:"
@@ -3499,7 +3499,7 @@
 #: ../page_stats_dialouts.ptl:168 ../page_stats_dialouts.ptl:171
 #: ../page_stats_phone.ptl:178
 msgid "Statistics of Calls by Dialout Entry:"
-msgstr "Estad?sticas de llamadas por Destino:"
+msgstr "Estad?sticas de llamadas por destino:"
 
 #: ../page_stats_phone.ptl:30 ../page_stats_phone.ptl:34
 msgid "Extension Statistics"
@@ -3507,7 +3507,7 @@
 
 #: ../page_stats_phone.ptl:31 ../page_stats_phone.ptl:35
 msgid "Statistics for an Extension"
-msgstr "Estad?sticas para una Extensi?n"
+msgstr "Estad?sticas para una extensi?n"
 
 #: ../page_stats_phone.ptl:166
 msgid "Statistics of Extension Calls by Dialout Entry:"
@@ -3523,11 +3523,11 @@
 
 #: ../page_stats_trunks.ptl:34
 msgid "Trunk Statistics"
-msgstr "Estad?sticas de Troncales"
+msgstr "Estad?sticas de troncales"
 
 #: ../page_stats_trunks.ptl:35
 msgid "Statistics for Trunks"
-msgstr "Estad?sticas de las Troncales"
+msgstr "Estad?sticas de las troncales"
 
 #: ../page_stats_trunks.ptl:158 ../page_stats_trunks.ptl:179
 msgid "Incomming Calls per Trunk"
@@ -3720,11 +3720,11 @@
 
 #: ../cfg_opt_user.py:40
 msgid "Virtual PBX Administrator"
-msgstr "Administrador de la PBX Virtual"
+msgstr "Administrador de la PBX virtual"
 
 #: ../cfg_opt_user.py:65
 msgid "Please choose a Virtual PBX for this user."
-msgstr "Por favor, escoja la PBX Virtual para este usuario."
+msgstr "Por favor, escoja la PBX virtual para este usuario."
 
 #: ../cfg_phone_hunt.py:27
 msgid "Simple Hunt Group"
@@ -3736,7 +3736,7 @@
 
 #: ../cfg_phone_hunt.py:37
 msgid "Cycle until timeout?"
-msgstr ""
+msgstr "?Rotar hasta que se alcance el tiempo m?ximo?"
 
 #: ../cfg_phone_hunt.py:37
 msgid "else it will give only two rounds"
@@ -3805,15 +3805,15 @@
 
 #: ../page_admin_systemstate.ptl:62
 msgid "Total Memory"
-msgstr "Memoria Total"
+msgstr "Memoria total"
 
 #: ../page_admin_systemstate.ptl:64
 msgid "Free Memory"
-msgstr "Memoria Libre"
+msgstr "Memoria libre"
 
 #: ../page_admin_systemstate.ptl:68
 msgid "Disk Usage"
-msgstr "Uso del Disco"
+msgstr "Uso del disco"
 
 #: ../page_admin_systemstate.ptl:71
 msgid "Device"
@@ -3825,7 +3825,7 @@
 
 #: ../page_admin_systemstate.ptl:73
 msgid "Total Size"
-msgstr "Tama?o Total"
+msgstr "Tama?o total"
 
 #: ../page_admin_systemstate.ptl:74
 msgid "Used"
@@ -3837,7 +3837,7 @@
 
 #: ../page_admin_systemstate.ptl:76
 msgid "Use percentage"
-msgstr "Porcentaje de Utilizaci?n"
+msgstr "Porcentaje de utilizaci?n"
 
 #: ../page_admin_systemstate.ptl:77
 msgid "Mount point"
@@ -3845,7 +3845,7 @@
 
 #: ../page_admin_viewconf.ptl:29
 msgid "Save/View Configuration"
-msgstr "Ver/Guardar Configuraci?n"
+msgstr "Ver/guardar configuraci?n"
 
 #: ../page_admin_viewconf.ptl:30
 msgid "Save and show Asterisk configuration files"
@@ -3925,7 +3925,7 @@
 
 #: ../cfg_opt_codec.py:29
 msgid "Audio Codec"
-msgstr "Codec de audio"
+msgstr "C?dec de audio"
 
 #: ../cfg_opt_codec.py:30
 msgid "New audio codec to be used"
@@ -3933,43 +3933,43 @@
 
 #: ../cfg_opt_codec.py:35
 msgid "Allow codec"
-msgstr "Permitir codec"
+msgstr "Permitir c?dec"
 
 #: ../cfg_opt_codec.py:37
 msgid "Use all codecs"
-msgstr "Usar todos los codecs"
+msgstr "Usar todos los c?decs"
 
 #: ../cfg_opt_codec.py:38
 msgid "A Law (g711a)"
-msgstr "Ley A (g711a)"
+msgstr "Ley a (g711a)"
 
 #: ../cfg_opt_codec.py:39
 msgid "U Law (g711u)"
-msgstr "Ley U (g711u)"
+msgstr "Ley u (g711u)"
 
 #: ../cfg_opt_codec.py:41
 msgid "ILBC"
-msgstr ""
+msgstr "ILBC"
 
 #: ../cfg_opt_codec.py:42
 msgid "g726"
-msgstr ""
+msgstr "g726"
 
 #: ../cfg_opt_codec.py:43
 msgid "g723.1"
-msgstr ""
+msgstr "g723.1"
 
 #: ../cfg_opt_codec.py:44
 msgid "g729"
-msgstr ""
+msgstr "g729"
 
 #: ../cfg_opt_sip_audio.py:29
 msgid "Depricated: use individual 'Audio Codec' configlets instead."
-msgstr "Descontinuado: use configlets \"Codec de Audio\" individuales."
+msgstr "Descontinuado: use configlets \"c?dec de audio\" individuales."
 
 #: ../cfg_opt_sip_audio.py:39
 msgid "Allow g726 codec"
-msgstr "Permitir codec g726"
+msgstr "Permitir c?dec g726"
 
 #: ../cfg_phone_iax.py:106
 msgid "Skip asterisk media path?"
@@ -3984,7 +3984,7 @@
 #: ../cfg_phone_iax.py:133 ../cfg_phone_mgcp.py:139 ../cfg_phone_queue.py:107
 #: ../cfg_phone_zap.py:137
 msgid "Otherwise it will use Date-CallerIdName(CallerIdNum)-Exten"
-msgstr "De otra forma se usar? Fecha-Identificador_de_Llamante-Extensi?n"
+msgstr "De otra forma se usar? Fecha-Identificador_de_llamante-Extensi?n"
 
 #: ../cfg_phone_sip.py:168 ../cfg_phone_sip.py:169 ../cfg_phone_epygi.py:168
 #: ../cfg_phone_iax.py:146 ../cfg_phone_mgcp.py:152 ../cfg_phone_queue.py:120
@@ -4009,7 +4009,7 @@
 #: ../cfg_phone_queue.py:141 ../cfg_phone_sip.py:182 ../cfg_phone_sip.py:196
 #: ../cfg_phone_zap.py:163 ../cfg_phone_zap.py:177
 msgid "+4"
-msgstr ""
+msgstr "+4"
 
 #: ../cfg_phone_sip.py:181 ../cfg_phone_sip.py:195 ../cfg_phone_sip.py:182
 #: ../cfg_phone_sip.py:196 ../cfg_phone_epygi.py:182 ../cfg_phone_epygi.py:196
@@ -4018,7 +4018,7 @@
 #: ../cfg_phone_queue.py:142 ../cfg_phone_sip.py:183 ../cfg_phone_sip.py:197
 #: ../cfg_phone_zap.py:164 ../cfg_phone_zap.py:178
 msgid "+3"
-msgstr ""
+msgstr "+3"
 
 #: ../cfg_phone_sip.py:182 ../cfg_phone_sip.py:196 ../cfg_phone_sip.py:183
 #: ../cfg_phone_sip.py:197 ../cfg_phone_epygi.py:183 ../cfg_phone_epygi.py:197
@@ -4027,7 +4027,7 @@
 #: ../cfg_phone_queue.py:143 ../cfg_phone_sip.py:184 ../cfg_phone_sip.py:198
 #: ../cfg_phone_zap.py:165 ../cfg_phone_zap.py:179
 msgid "+2"
-msgstr ""
+msgstr "+2"
 
 #: ../cfg_phone_sip.py:183 ../cfg_phone_sip.py:197 ../cfg_phone_sip.py:184
 #: ../cfg_phone_sip.py:198 ../cfg_phone_epygi.py:184 ../cfg_phone_epygi.py:198
@@ -4036,7 +4036,7 @@
 #: ../cfg_phone_queue.py:144 ../cfg_phone_sip.py:185 ../cfg_phone_sip.py:199
 #: ../cfg_phone_zap.py:166 ../cfg_phone_zap.py:180
 msgid "+1"
-msgstr ""
+msgstr "+1"
 
 #: ../cfg_phone_sip.py:184 ../cfg_phone_sip.py:198 ../cfg_phone_sip.py:185
 #: ../cfg_phone_sip.py:199 ../cfg_phone_epygi.py:185 ../cfg_phone_epygi.py:199
@@ -4045,7 +4045,7 @@
 #: ../cfg_phone_queue.py:145 ../cfg_phone_sip.py:186 ../cfg_phone_sip.py:200
 #: ../cfg_phone_zap.py:167 ../cfg_phone_zap.py:181
 msgid "0"
-msgstr ""
+msgstr "0"
 
 #: ../cfg_phone_sip.py:185 ../cfg_phone_sip.py:199 ../cfg_phone_sip.py:186
 #: ../cfg_phone_sip.py:200 ../cfg_phone_epygi.py:186 ../cfg_phone_epygi.py:200
@@ -4054,7 +4054,7 @@
 #: ../cfg_phone_queue.py:146 ../cfg_phone_sip.py:187 ../cfg_phone_sip.py:201
 #: ../cfg_phone_zap.py:168 ../cfg_phone_zap.py:182
 msgid "-1"
-msgstr ""
+msgstr "-1"
 
 #: ../cfg_phone_sip.py:186 ../cfg_phone_sip.py:200 ../cfg_phone_sip.py:187
 #: ../cfg_phone_sip.py:201 ../cfg_phone_epygi.py:187 ../cfg_phone_epygi.py:201
@@ -4063,7 +4063,7 @@
 #: ../cfg_phone_queue.py:147 ../cfg_phone_sip.py:188 ../cfg_phone_sip.py:202
 #: ../cfg_phone_zap.py:169 ../cfg_phone_zap.py:183
 msgid "-2"
-msgstr ""
+msgstr "-2"
 
 #: ../cfg_phone_sip.py:187 ../cfg_phone_sip.py:201 ../cfg_phone_sip.py:188
 #: ../cfg_phone_sip.py:202 ../cfg_phone_epygi.py:188 ../cfg_phone_epygi.py:202
@@ -4072,7 +4072,7 @@
 #: ../cfg_phone_queue.py:148 ../cfg_phone_sip.py:189 ../cfg_phone_sip.py:203
 #: ../cfg_phone_zap.py:170 ../cfg_phone_zap.py:184
 msgid "-3"
-msgstr ""
+msgstr "-3"
 
 #: ../cfg_phone_sip.py:188 ../cfg_phone_sip.py:202 ../cfg_phone_sip.py:189
 #: ../cfg_phone_sip.py:203 ../cfg_phone_epygi.py:189 ../cfg_phone_epygi.py:203
@@ -4081,7 +4081,7 @@
 #: ../cfg_phone_queue.py:149 ../cfg_phone_sip.py:190 ../cfg_phone_sip.py:204
 #: ../cfg_phone_zap.py:171 ../cfg_phone_zap.py:185
 msgid "-4"
-msgstr ""
+msgstr "-4"
 
 #: ../cfg_phone_sip.py:192 ../cfg_phone_sip.py:193 ../cfg_phone_epygi.py:193
 #: ../cfg_phone_iax.py:171 ../cfg_phone_mgcp.py:177 ../cfg_phone_queue.py:139
@@ -4100,7 +4100,7 @@
 
 #: ../page_admin_viewconf.ptl:29
 msgid "View/Save Configuration"
-msgstr "Ver/Guardar Configuraci?n"
+msgstr "Ver/guardar configuraci?n"
 
 #: ../page_admin_viewconf.ptl:30
 msgid "Show and Save Asterisk configuration files"
@@ -4140,11 +4140,11 @@
 
 #: ../page_config_codecs.ptl:27
 msgid "Codecs"
-msgstr ""
+msgstr "C?decs"
 
 #: ../page_config_codecs.ptl:28
 msgid "Audio codecs to use on SIP and IAX channels."
-msgstr "Codecs de audio a usar en los canales SIP e IAX"
+msgstr "C?decs de audio a usar en los canales SIP e IAX"
 
 #: ../page_config.ptl:107
 #, python-format
@@ -4183,7 +4183,7 @@
 "This is a SIP phone account, to be used by hard-phones, soft-phones, ATAs, "
 "etc."
 msgstr ""
-"Esta es una cuenta de extensi?n SIP para ser utilizada por tel?fonos IP "
+"?sta es una cuenta de extensi?n SIP para ser utilizada por tel?fonos IP "
 "hardware y software, ATAs, etc."
 
 #: ../configlets.py:696



From dasenjo at mail.berlios.de  Tue Apr 17 19:59:44 2007
From: dasenjo at mail.berlios.de (dasenjo at BerliOS)
Date: Tue, 17 Apr 2007 19:59:44 +0200
Subject: [Destar-dev] r656 - branches/0.2.X
Message-ID: <200704171759.l3HHxiK8007967@sheep.berlios.de>

Author: dasenjo
Date: 2007-04-17 19:59:42 +0200 (Tue, 17 Apr 2007)
New Revision: 656

Modified:
   branches/0.2.X/CHANGELOG.txt
   branches/0.2.X/page_stats_qcallback.ptl
   branches/0.2.X/page_stats_queue.ptl
Log:
* Added line to call loadQueueLog every time the queues statistics are seen.
;


Modified: branches/0.2.X/CHANGELOG.txt
===================================================================
--- branches/0.2.X/CHANGELOG.txt	2007-04-17 03:11:41 UTC (rev 655)
+++ branches/0.2.X/CHANGELOG.txt	2007-04-17 17:59:42 UTC (rev 656)
@@ -1,4 +1,7 @@
-2001-04-16:
+2007-04-17:
+* Added line to call loadQueueLog every time the queues statistics are seen.
+
+2007-04-16:
 * Configlets that extends from CfgOptSingle now can be deleted.
 * Fixed Bug #8932
 

Modified: branches/0.2.X/page_stats_qcallback.ptl
===================================================================
--- branches/0.2.X/page_stats_qcallback.ptl	2007-04-17 03:11:41 UTC (rev 655)
+++ branches/0.2.X/page_stats_qcallback.ptl	2007-04-17 17:59:42 UTC (rev 656)
@@ -224,6 +224,7 @@
 	
 def _q_index [plain] (request):
 	header(_q_desc)
+	x = queueutils.loadQueueLog()
 	if pychart_exists:
 		cdrForm(request)
 	else:

Modified: branches/0.2.X/page_stats_queue.ptl
===================================================================
--- branches/0.2.X/page_stats_queue.ptl	2007-04-17 03:11:41 UTC (rev 655)
+++ branches/0.2.X/page_stats_queue.ptl	2007-04-17 17:59:42 UTC (rev 656)
@@ -473,6 +473,7 @@
 	
 def _q_index [plain] (request):
 	header(_q_desc)
+	x = queueutils.loadQueueLog()
 	if pychart_exists:
 		cdrForm(request)
 	else:



From santiago at mail.berlios.de  Wed Apr 18 16:27:10 2007
From: santiago at mail.berlios.de (santiago at BerliOS)
Date: Wed, 18 Apr 2007 16:27:10 +0200
Subject: [Destar-dev] r657 - trunk
Message-ID: <200704181427.l3IERA03022090@sheep.berlios.de>

Author: santiago
Date: 2007-04-18 16:27:09 +0200 (Wed, 18 Apr 2007)
New Revision: 657

Added:
   trunk/cfg_app_agentcallbacklogin.py
   trunk/page_config_agents.ptl
Modified:
   trunk/CHANGELOG.txt
   trunk/cfg_phone_agent.py
Log:
* Added AgentCallbackLogin config
* Added agent config page



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-17 17:59:42 UTC (rev 656)
+++ trunk/CHANGELOG.txt	2007-04-18 14:27:09 UTC (rev 657)
@@ -1,3 +1,7 @@
+2007-04-18:
+* Added AgentCallbackLogin config
+* Added agent config page
+
 2007-04-16:
 * Configlets that extends from CfgOptSingle now can be deleted.
 * Fixed Bug #8932

Added: trunk/cfg_app_agentcallbacklogin.py
===================================================================
--- trunk/cfg_app_agentcallbacklogin.py	2007-04-17 17:59:42 UTC (rev 656)
+++ trunk/cfg_app_agentcallbacklogin.py	2007-04-18 14:27:09 UTC (rev 657)
@@ -0,0 +1,57 @@
+# -*- coding: utf-8 -*-
+#
+# Destar has Copyright (C) 2007 by Holger Schurig
+# 
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+#
+
+
+from configlets import *
+
+class CfgAppAgentCallbackLogin(CfgApp):
+
+	shortName   = _("Agent Callback login/logout extensions")
+	newObjectTitle  = _("New agent callback login and logout extensions")
+	description = _("""This application allows an agent to log into the system.""")
+	
+	def createVariables(self):
+		self.variables = [
+			VarType("pbx",
+					title=_("Virtual PBX"),
+					type="choice",
+					options=getChoice("CfgOptPBX")),
+
+			VarType("loginext",
+					title=_("Login extension"),
+					len=6),
+
+			VarType("logoutext",
+					title=_("Logout extension"),
+					len=6),
+			]
+
+		self.dependencies = [ DepType("pbx", 
+					type="hard",
+					message = _("This is a Dependency")),
+			]
+
+	def createAsteriskConfig(self):
+		needModule("chan_agent")
+	
+		c = AstConf("extensions.conf")
+		c.setSection(self.pbx)
+		c.appendExten(self.loginext, "AgentCallbackLogin(||${CALLERIDNUM})")
+		c.appendExten(self.logoutext, "AgentCallbackLogin(||l)")
+

Modified: trunk/cfg_phone_agent.py
===================================================================
--- trunk/cfg_phone_agent.py	2007-04-17 17:59:42 UTC (rev 656)
+++ trunk/cfg_phone_agent.py	2007-04-18 14:27:09 UTC (rev 657)
@@ -1,7 +1,7 @@
 # -*- coding: utf-8 -*-
 #
 # Copyright (C) 2005 by Holger Schurig,
-# add ons by Michael Bielicki, TAAN Softworks Corp.
+# this module was written by Diego Andr?s Asenjo.
 # 
 # This program is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
@@ -21,12 +21,13 @@
 
 from configlets import *
 
-class CfgPhoneAgent(CfgPhone):
+class CfgAgent(CfgPhone):
 
 	shortName = _("Agent")
 	newObjectTitle = _("New agent")
 	description = _("This is a queue agent")
 	technology = "AGENT"
+	groupName = "Agents"
 	
 	def createVariables(self):
 		self.variables = [

Added: trunk/page_config_agents.ptl
===================================================================
--- trunk/page_config_agents.ptl	2007-04-17 17:59:42 UTC (rev 656)
+++ trunk/page_config_agents.ptl	2007-04-18 14:27:09 UTC (rev 657)
@@ -0,0 +1,46 @@
+# -*- coding: utf-8 -*-
+#
+# Copyright (C) 2005 by Holger Schurig
+# 
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+#
+
+
+from Templates import *
+from ConfigHelper import *
+from quixote.directory import Directory, AccessControlled
+from quixote import get_request, get_session
+
+class Page(AccessControlled, Directory): 
+
+	_q_parent  = 'page_config'
+	_q_title   = _("Agents")
+	_q_desc    = _("Agents and their settings")
+	_q_link    = 'agents'
+	_q_menupos = 25
+	_q_level   = 3
+
+	_q_exports = ['']
+
+	def _q_access(self):
+		self.session = get_session()
+		self.request = get_request()
+		if self.session.level < self._q_level:
+			cantAccessPage()
+
+	def _q_index [plain] (self):
+		header(self._q_desc)
+		presentConfiglets('Agents')
+		footer()



From santiago at mail.berlios.de  Thu Apr 19 18:09:23 2007
From: santiago at mail.berlios.de (santiago at BerliOS)
Date: Thu, 19 Apr 2007 18:09:23 +0200
Subject: [Destar-dev] r658 - trunk
Message-ID: <200704191609.l3JG9NW4013880@sheep.berlios.de>

Author: santiago
Date: 2007-04-19 18:09:22 +0200 (Thu, 19 Apr 2007)
New Revision: 658

Modified:
   trunk/CHANGELOG.txt
   trunk/configlets.py
Log:
configlets.py: fixed technologies for agents



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-18 14:27:09 UTC (rev 657)
+++ trunk/CHANGELOG.txt	2007-04-19 16:09:22 UTC (rev 658)
@@ -1,3 +1,6 @@
+2007-04-19:
+* configlets.py: fixed technologies for agents
+
 2007-04-18:
 * Added AgentCallbackLogin config
 * Added agent config page

Modified: trunk/configlets.py
===================================================================
--- trunk/configlets.py	2007-04-18 14:27:09 UTC (rev 657)
+++ trunk/configlets.py	2007-04-19 16:09:22 UTC (rev 658)
@@ -1053,7 +1053,7 @@
 				c = AstConf("queues.conf")
 				for queue in self.queues.split(','):
 					c.setSection(queue)
-					if self.technology == 'SIP' or self.technology == 'IAX':
+					if self.technology == 'SIP' or self.technology == 'IAX2' or self.technology == 'ZAP':
 						c.append("member => %s/%s" % (self.technology,self.name))
 					if self.technology == 'AGENT':
 						c.append("member => %s/%s" % (self.technology,self.number))



From santiago at mail.berlios.de  Thu Apr 19 18:11:05 2007
From: santiago at mail.berlios.de (santiago at BerliOS)
Date: Thu, 19 Apr 2007 18:11:05 +0200
Subject: [Destar-dev] r659 - trunk
Message-ID: <200704191611.l3JGB5fE014075@sheep.berlios.de>

Author: santiago
Date: 2007-04-19 18:11:04 +0200 (Thu, 19 Apr 2007)
New Revision: 659

Modified:
   trunk/CHANGELOG.txt
   trunk/cfg_phone_agent.py
Log:
* cfg_phone_agent.py: allow agents with no password



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-19 16:09:22 UTC (rev 658)
+++ trunk/CHANGELOG.txt	2007-04-19 16:11:04 UTC (rev 659)
@@ -1,5 +1,6 @@
 2007-04-19:
 * configlets.py: fixed technologies for agents
+* cfg_phone_agent.py: allow agents with no password
 
 2007-04-18:
 * Added AgentCallbackLogin config

Modified: trunk/cfg_phone_agent.py
===================================================================
--- trunk/cfg_phone_agent.py	2007-04-19 16:09:22 UTC (rev 658)
+++ trunk/cfg_phone_agent.py	2007-04-19 16:11:04 UTC (rev 659)
@@ -48,6 +48,7 @@
 			VarType("secret",
 					title=_("Password"),
 					type="int",
+					optional=True
 					len=15),
 					
 			VarType("QueueLab",



From santiago at mail.berlios.de  Thu Apr 19 18:15:28 2007
From: santiago at mail.berlios.de (santiago at BerliOS)
Date: Thu, 19 Apr 2007 18:15:28 +0200
Subject: [Destar-dev] r660 - trunk
Message-ID: <200704191615.l3JGFS6J014561@sheep.berlios.de>

Author: santiago
Date: 2007-04-19 18:15:28 +0200 (Thu, 19 Apr 2007)
New Revision: 660

Modified:
   trunk/CHANGELOG.txt
   trunk/cfg_app_agentcallbacklogin.py
Log:
* cfg_app_agentcallbacklogin.py, added change location ext,
  allow silent login, automatic logout



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-19 16:11:04 UTC (rev 659)
+++ trunk/CHANGELOG.txt	2007-04-19 16:15:28 UTC (rev 660)
@@ -1,6 +1,8 @@
 2007-04-19:
 * configlets.py: fixed technologies for agents
 * cfg_phone_agent.py: allow agents with no password
+* cfg_app_agentcallbacklogin.py, added change location ext,
+  allow silent login, automatic logout
 
 2007-04-18:
 * Added AgentCallbackLogin config

Modified: trunk/cfg_app_agentcallbacklogin.py
===================================================================
--- trunk/cfg_app_agentcallbacklogin.py	2007-04-19 16:11:04 UTC (rev 659)
+++ trunk/cfg_app_agentcallbacklogin.py	2007-04-19 16:15:28 UTC (rev 660)
@@ -33,13 +33,22 @@
 					type="choice",
 					options=getChoice("CfgOptPBX")),
 
-			VarType("loginext",
+			VarType("ext",
 					title=_("Login extension"),
 					len=6),
 
+			VarType("changeext",
+					title=_("Change location"),
+					len=6),
+
 			VarType("logoutext",
 					title=_("Logout extension"),
 					len=6),
+
+			VarType("silentlogin",
+					title=_("Silent login"),
+					type="bool",
+					optional=True),
 			]
 
 		self.dependencies = [ DepType("pbx", 
@@ -49,9 +58,17 @@
 
 	def createAsteriskConfig(self):
 		needModule("chan_agent")
+		needModule("chan_local")
 	
 		c = AstConf("extensions.conf")
 		c.setSection(self.pbx)
-		c.appendExten(self.loginext, "AgentCallbackLogin(||${CALLERIDNUM})")
-		c.appendExten(self.logoutext, "AgentCallbackLogin(||l)")
 
+		if self.silentlogin:
+			opts = "s"
+		else:
+			opts = ""
+		
+		c.appendExten(self.ext, "AgentCallbackLogin(${CALLERIDNUM}|%s|${CALLERIDNUM}@%s)" % (opts, self.pbx) )
+		c.appendExten(self.changeext, "AgentCallbackLogin(${CALLERIDNUM}|%s|'#')" , % (opts) )
+		c.appendExten(self.logoutext, "Dial(Local/*%s at pbx1/n,,D(#))" % self.changeext)
+



From santiago at mail.berlios.de  Thu Apr 19 18:52:32 2007
From: santiago at mail.berlios.de (santiago at BerliOS)
Date: Thu, 19 Apr 2007 18:52:32 +0200
Subject: [Destar-dev] r661 - trunk
Message-ID: <200704191652.l3JGqW7K012138@sheep.berlios.de>

Author: santiago
Date: 2007-04-19 18:52:27 +0200 (Thu, 19 Apr 2007)
New Revision: 661

Modified:
   trunk/cfg_phone_agent.py
Log:
allow empty password



Modified: trunk/cfg_phone_agent.py
===================================================================
--- trunk/cfg_phone_agent.py	2007-04-19 16:15:28 UTC (rev 660)
+++ trunk/cfg_phone_agent.py	2007-04-19 16:52:27 UTC (rev 661)
@@ -48,7 +48,7 @@
 			VarType("secret",
 					title=_("Password"),
 					type="int",
-					optional=True
+					optional=True,
 					len=15),
 					
 			VarType("QueueLab",
@@ -79,6 +79,11 @@
 
 		ag = AstConf("agents.conf")
 		ag.setSection("agents")
-		ag.append("agent=%d,%d,%s" % (self.number, self.secret, self.name))
+		if self.secret:
+			ag.append("agent=%d,%d,%s" % (self.number, self.secret, self.name))
+		else:
+			ag.append("agent=%d,,%s" % (self.number, self.name))
 
+
+
 		self.createQueuesConfig()



From santiago at mail.berlios.de  Thu Apr 19 18:56:59 2007
From: santiago at mail.berlios.de (santiago at BerliOS)
Date: Thu, 19 Apr 2007 18:56:59 +0200
Subject: [Destar-dev] r662 - trunk
Message-ID: <200704191656.l3JGuxAG016144@sheep.berlios.de>

Author: santiago
Date: 2007-04-19 18:56:44 +0200 (Thu, 19 Apr 2007)
New Revision: 662

Modified:
   trunk/cfg_app_agentcallbacklogin.py
Log:
errata



Modified: trunk/cfg_app_agentcallbacklogin.py
===================================================================
--- trunk/cfg_app_agentcallbacklogin.py	2007-04-19 16:52:27 UTC (rev 661)
+++ trunk/cfg_app_agentcallbacklogin.py	2007-04-19 16:56:44 UTC (rev 662)
@@ -69,6 +69,6 @@
 			opts = ""
 		
 		c.appendExten(self.ext, "AgentCallbackLogin(${CALLERIDNUM}|%s|${CALLERIDNUM}@%s)" % (opts, self.pbx) )
-		c.appendExten(self.changeext, "AgentCallbackLogin(${CALLERIDNUM}|%s|'#')" , % (opts) )
-		c.appendExten(self.logoutext, "Dial(Local/*%s at pbx1/n,,D(#))" % self.changeext)
+		c.appendExten(self.changeext, "AgentCallbackLogin(${CALLERIDNUM}|%s|'#')" % (opts) )
+		c.appendExten(self.logoutext, "Dial(Local/%s at pbx1/n,,D(#))" % self.changeext)
 



From santiago at mail.berlios.de  Thu Apr 19 19:00:03 2007
From: santiago at mail.berlios.de (santiago at BerliOS)
Date: Thu, 19 Apr 2007 19:00:03 +0200
Subject: [Destar-dev] r663 - trunk
Message-ID: <200704191700.l3JH03iU019110@sheep.berlios.de>

Author: santiago
Date: 2007-04-19 18:59:58 +0200 (Thu, 19 Apr 2007)
New Revision: 663

Modified:
   trunk/CHANGELOG.txt
   trunk/configlets.py
Log:
persistent queues members



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-19 16:56:44 UTC (rev 662)
+++ trunk/CHANGELOG.txt	2007-04-19 16:59:58 UTC (rev 663)
@@ -1,5 +1,5 @@
 2007-04-19:
-* configlets.py: fixed technologies for agents
+* configlets.py: fixed technologies for agents, persistent queues members
 * cfg_phone_agent.py: allow agents with no password
 * cfg_app_agentcallbacklogin.py, added change location ext,
   allow silent login, automatic logout

Modified: trunk/configlets.py
===================================================================
--- trunk/configlets.py	2007-04-19 16:56:44 UTC (rev 662)
+++ trunk/configlets.py	2007-04-19 16:59:58 UTC (rev 663)
@@ -1051,6 +1051,8 @@
 		try:
 			if self.queues:
 				c = AstConf("queues.conf")
+				c.setSection("general")
+				c.append("persistentmembers = yes")
 				for queue in self.queues.split(','):
 					c.setSection(queue)
 					if self.technology == 'SIP' or self.technology == 'IAX2' or self.technology == 'ZAP':



From dasenjo at mail.berlios.de  Thu Apr 19 19:23:34 2007
From: dasenjo at mail.berlios.de (dasenjo at BerliOS)
Date: Thu, 19 Apr 2007 19:23:34 +0200
Subject: [Destar-dev] r664 - trunk
Message-ID: <200704191723.l3JHNYdp012797@sheep.berlios.de>

Author: dasenjo
Date: 2007-04-19 19:23:33 +0200 (Thu, 19 Apr 2007)
New Revision: 664

Added:
   trunk/page_config_queues.ptl
Removed:
   trunk/page_config_agents.ptl
Modified:
   trunk/CHANGELOG.txt
   trunk/cfg_phone_agent.py
   trunk/cfg_phone_queue.py
Log:
* New groupName and ptl for queues and agents



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-19 16:59:58 UTC (rev 663)
+++ trunk/CHANGELOG.txt	2007-04-19 17:23:33 UTC (rev 664)
@@ -3,6 +3,7 @@
 * cfg_phone_agent.py: allow agents with no password
 * cfg_app_agentcallbacklogin.py, added change location ext,
   allow silent login, automatic logout
+* New groupName and ptl for queues and agents
 
 2007-04-18:
 * Added AgentCallbackLogin config

Modified: trunk/cfg_phone_agent.py
===================================================================
--- trunk/cfg_phone_agent.py	2007-04-19 16:59:58 UTC (rev 663)
+++ trunk/cfg_phone_agent.py	2007-04-19 17:23:33 UTC (rev 664)
@@ -27,7 +27,7 @@
 	newObjectTitle = _("New agent")
 	description = _("This is a queue agent")
 	technology = "AGENT"
-	groupName = "Agents"
+	groupName = "Queues"
 	
 	def createVariables(self):
 		self.variables = [

Modified: trunk/cfg_phone_queue.py
===================================================================
--- trunk/cfg_phone_queue.py	2007-04-19 16:59:58 UTC (rev 663)
+++ trunk/cfg_phone_queue.py	2007-04-19 17:23:33 UTC (rev 664)
@@ -27,6 +27,7 @@
 	shortName = _("Normal Call Queue")
 	newObjectTitle = _("New Call Queue")
 	technology = "QUEUE"
+	groupName = "Queues"
 	
 	def createVariables(self):
 		self.variables = [

Deleted: trunk/page_config_agents.ptl
===================================================================
--- trunk/page_config_agents.ptl	2007-04-19 16:59:58 UTC (rev 663)
+++ trunk/page_config_agents.ptl	2007-04-19 17:23:33 UTC (rev 664)
@@ -1,46 +0,0 @@
-# -*- coding: utf-8 -*-
-#
-# Copyright (C) 2005 by Holger Schurig
-# 
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2 of the License, or
-# (at your option) any later version.
-#
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-#
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
-#
-
-
-from Templates import *
-from ConfigHelper import *
-from quixote.directory import Directory, AccessControlled
-from quixote import get_request, get_session
-
-class Page(AccessControlled, Directory): 
-
-	_q_parent  = 'page_config'
-	_q_title   = _("Agents")
-	_q_desc    = _("Agents and their settings")
-	_q_link    = 'agents'
-	_q_menupos = 25
-	_q_level   = 3
-
-	_q_exports = ['']
-
-	def _q_access(self):
-		self.session = get_session()
-		self.request = get_request()
-		if self.session.level < self._q_level:
-			cantAccessPage()
-
-	def _q_index [plain] (self):
-		header(self._q_desc)
-		presentConfiglets('Agents')
-		footer()

Copied: trunk/page_config_queues.ptl (from rev 660, trunk/page_config_agents.ptl)
===================================================================
--- trunk/page_config_agents.ptl	2007-04-19 16:15:28 UTC (rev 660)
+++ trunk/page_config_queues.ptl	2007-04-19 17:23:33 UTC (rev 664)
@@ -0,0 +1,46 @@
+# -*- coding: utf-8 -*-
+#
+# Copyright (C) 2005 by Holger Schurig
+# 
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+#
+
+
+from Templates import *
+from ConfigHelper import *
+from quixote.directory import Directory, AccessControlled
+from quixote import get_request, get_session
+
+class Page(AccessControlled, Directory): 
+
+	_q_parent  = 'page_config'
+	_q_title   = _("Queues")
+	_q_desc    = _("Queues and agents and their settings")
+	_q_link    = 'queues'
+	_q_menupos = 25
+	_q_level   = 3
+
+	_q_exports = ['']
+
+	def _q_access(self):
+		self.session = get_session()
+		self.request = get_request()
+		if self.session.level < self._q_level:
+			cantAccessPage()
+
+	def _q_index [plain] (self):
+		header(self._q_desc)
+		presentConfiglets('Queues')
+		footer()



From santiago at mail.berlios.de  Fri Apr 20 06:44:33 2007
From: santiago at mail.berlios.de (santiago at BerliOS)
Date: Fri, 20 Apr 2007 06:44:33 +0200
Subject: [Destar-dev] r665 - trunk
Message-ID: <200704200444.l3K4iXUq002259@sheep.berlios.de>

Author: santiago
Date: 2007-04-20 06:44:27 +0200 (Fri, 20 Apr 2007)
New Revision: 665

Modified:
   trunk/CHANGELOG.txt
   trunk/cfg_app_agentcallbacklogin.py
Log:
remove DND when agent logs in.



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-19 17:23:33 UTC (rev 664)
+++ trunk/CHANGELOG.txt	2007-04-20 04:44:27 UTC (rev 665)
@@ -2,7 +2,8 @@
 * configlets.py: fixed technologies for agents, persistent queues members
 * cfg_phone_agent.py: allow agents with no password
 * cfg_app_agentcallbacklogin.py, added change location ext,
-  allow silent login, automatic logout
+  allow silent login, automatic logout,
+  remove DND when agent logs in.
 * New groupName and ptl for queues and agents
 
 2007-04-18:

Modified: trunk/cfg_app_agentcallbacklogin.py
===================================================================
--- trunk/cfg_app_agentcallbacklogin.py	2007-04-19 17:23:33 UTC (rev 664)
+++ trunk/cfg_app_agentcallbacklogin.py	2007-04-20 04:44:27 UTC (rev 665)
@@ -69,6 +69,11 @@
 			opts = ""
 		
 		c.appendExten(self.ext, "AgentCallbackLogin(${CALLERIDNUM}|%s|${CALLERIDNUM}@%s)" % (opts, self.pbx) )
+		c.appendExten(self.ext, "DBdel(DND/%s/${CALLERIDNUM})")
+		c.appendExten(self.ext, "Playback(do-not-disturb)")
+		c.appendExten(self.ext, "Playback(cancelled)")
+		c.appendExten(self.ext, "Hangup")
+
 		c.appendExten(self.changeext, "AgentCallbackLogin(${CALLERIDNUM}|%s|'#')" % (opts) )
 		c.appendExten(self.logoutext, "Dial(Local/%s at pbx1/n,,D(#))" % self.changeext)
 



From santiago at mail.berlios.de  Fri Apr 20 07:14:47 2007
From: santiago at mail.berlios.de (santiago at BerliOS)
Date: Fri, 20 Apr 2007 07:14:47 +0200
Subject: [Destar-dev] r666 - trunk
Message-ID: <200704200514.l3K5ElvL028516@sheep.berlios.de>

Author: santiago
Date: 2007-04-20 07:14:41 +0200 (Fri, 20 Apr 2007)
New Revision: 666

Added:
   trunk/cfg_opt_queuesagents.py
Modified:
   trunk/CHANGELOG.txt
   trunk/configlets.py
Log:
queues and agents general settings in cfg_opt_queuesagents.py



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-20 04:44:27 UTC (rev 665)
+++ trunk/CHANGELOG.txt	2007-04-20 05:14:41 UTC (rev 666)
@@ -1,3 +1,6 @@
+2007-04-20:
+* queues and agents general settings in cfg_opt_queuesagents.py.  
+
 2007-04-19:
 * configlets.py: fixed technologies for agents, persistent queues members
 * cfg_phone_agent.py: allow agents with no password

Added: trunk/cfg_opt_queuesagents.py
===================================================================
--- trunk/cfg_opt_queuesagents.py	2007-04-20 04:44:27 UTC (rev 665)
+++ trunk/cfg_opt_queuesagents.py	2007-04-20 05:14:41 UTC (rev 666)
@@ -0,0 +1,69 @@
+# -*- coding: utf-8 -*-
+#
+# Destar has Copyright (C) 2007 by Holger Schurig
+# This file has Copyright (C) 2007 by Santiago Ruano Rinc?n
+# 
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+#
+
+from configlets import *
+
+
+class CfgOptOQueuesAgents(CfgOptSingle):
+
+	shortName = _("Queues and Agents")
+	newObjectTitle= _("Queues and Agents")
+	description = _("General settings for Queues and Agents")
+	groupName = 'Options'
+	 
+	def createVariables(self):
+		self.variables = [
+			VarType("labelqueues",
+				title=_("Queues settings"),
+				type="label"),
+
+			VarType("persistentmembers",
+				title=_("Queues persistent members:"),
+				type="bool",
+				default=True,
+				optional=True),
+
+			VarType("labelagents",
+				title=_("Agents settings"),
+				type="label"),
+
+			VarType("persistentagents",
+				title=_("Persistent agents:"),
+				type="bool",
+				default=True,
+				optional=True),
+
+			]
+
+	def createAsteriskConfig(self):
+		c = AstConf("queues.conf")
+                c.setSection("general")
+		if self.persistentmembers:
+			c.append("persistentmembers = yes")	
+		else:
+			c.append("persistentmembers = no")	
+
+		c = AstConf("agents.conf")
+                c.setSection("general")
+		if self.persistentagents:
+			c.append("persistentagents = yes")	
+		else:
+			c.append("persistentagents = no")	
+

Modified: trunk/configlets.py
===================================================================
--- trunk/configlets.py	2007-04-20 04:44:27 UTC (rev 665)
+++ trunk/configlets.py	2007-04-20 05:14:41 UTC (rev 666)
@@ -1051,8 +1051,6 @@
 		try:
 			if self.queues:
 				c = AstConf("queues.conf")
-				c.setSection("general")
-				c.append("persistentmembers = yes")
 				for queue in self.queues.split(','):
 					c.setSection(queue)
 					if self.technology == 'SIP' or self.technology == 'IAX2' or self.technology == 'ZAP':



From dasenjo at mail.berlios.de  Fri Apr 20 18:34:31 2007
From: dasenjo at mail.berlios.de (dasenjo at BerliOS)
Date: Fri, 20 Apr 2007 18:34:31 +0200
Subject: [Destar-dev] r667 - branches/0.2.X trunk
Message-ID: <200704201634.l3KGYVxa019640@sheep.berlios.de>

Author: dasenjo
Date: 2007-04-20 18:34:23 +0200 (Fri, 20 Apr 2007)
New Revision: 667

Modified:
   branches/0.2.X/CHANGELOG.txt
   branches/0.2.X/page_login.ptl
   trunk/CHANGELOG.txt
   trunk/page_login.ptl
Log:
* Fixed bug in the login page.



Modified: branches/0.2.X/CHANGELOG.txt
===================================================================
--- branches/0.2.X/CHANGELOG.txt	2007-04-20 05:14:41 UTC (rev 666)
+++ branches/0.2.X/CHANGELOG.txt	2007-04-20 16:34:23 UTC (rev 667)
@@ -1,3 +1,6 @@
+2007-04-19:
+* Fixed bug in the login page.
+
 2007-04-17:
 * Added line to call loadQueueLog every time the queues statistics are seen.
 

Modified: branches/0.2.X/page_login.ptl
===================================================================
--- branches/0.2.X/page_login.ptl	2007-04-20 05:14:41 UTC (rev 666)
+++ branches/0.2.X/page_login.ptl	2007-04-20 16:34:23 UTC (rev 667)
@@ -76,7 +76,9 @@
 
 		# Now search for a phone entry with proper extension/voicemail pin
 		for obj in backend.getConfiglets(group="Phones"):
-			if (obj.ext==res[0] or obj.name==res[0]) and (obj.secret==res[1] or obj.pin==res[1]):
+			if type(obj) == 'CfgPhoneExtension':
+				continue
+			if (obj.ext==res[0] or obj.name==res[0]) and (obj.secret==res[1] or str(obj.pin)==res[1]):
 				request.session.user  = obj.name
 				request.session.level = 1
 				request.session.phone = obj.name

Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-20 05:14:41 UTC (rev 666)
+++ trunk/CHANGELOG.txt	2007-04-20 16:34:23 UTC (rev 667)
@@ -8,6 +8,7 @@
   allow silent login, automatic logout,
   remove DND when agent logs in.
 * New groupName and ptl for queues and agents
+* Fixed bug in the login page.
 
 2007-04-18:
 * Added AgentCallbackLogin config

Modified: trunk/page_login.ptl
===================================================================
--- trunk/page_login.ptl	2007-04-20 05:14:41 UTC (rev 666)
+++ trunk/page_login.ptl	2007-04-20 16:34:23 UTC (rev 667)
@@ -82,16 +82,18 @@
 					self.session.phone = obj.phone
 					self.session.language = obj.language
 					self.session.pbx = obj.pbx
-					return redirect(str('../user/info'))
+					return redirect('../user/info/')
 
 			# Now search for a phone entry with proper extension/voicemail pin
 			for obj in backend.getConfiglets(group="Phones"):
-				if (obj.ext==res[0] or obj.name==res[0]) and (obj.secret==res[1] or obj.pin==res[1]):
+				if type(obj) == 'CfgPhoneExtension':
+					continue
+				if (obj.ext==res[0] or obj.name==res[0]) and (obj.secret==res[1] or str(obj.pin)==res[1]):
 					self.session.user  = obj.name
 					self.session.level = 1
 					self.session.phone = obj.name
 					self.session.language = 'en'
 					self.session.pbx = obj.pbx
-					return redirect(str('../user/info'))
+					return redirect('../user/info/')
 			self.notLoggedIn()
 		footer()



From dasenjo at mail.berlios.de  Wed Apr 25 02:42:30 2007
From: dasenjo at mail.berlios.de (dasenjo at BerliOS)
Date: Wed, 25 Apr 2007 02:42:30 +0200
Subject: [Destar-dev] r668 - trunk
Message-ID: <200704250042.l3P0gUor017441@sheep.berlios.de>

Author: dasenjo
Date: 2007-04-25 02:42:28 +0200 (Wed, 25 Apr 2007)
New Revision: 668

Modified:
   trunk/CHANGELOG.txt
   trunk/cfg_app_agentcallbacklogin.py
Log:
* Use actual pbx instead pbx1 in cfg_app_agentcallbacklogin



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-20 16:34:23 UTC (rev 667)
+++ trunk/CHANGELOG.txt	2007-04-25 00:42:28 UTC (rev 668)
@@ -1,3 +1,6 @@
+2007-04-24:
+* Use actual pbx instead pbx1 in cfg_app_agentcallbacklogin
+
 2007-04-20:
 * queues and agents general settings in cfg_opt_queuesagents.py.  
 

Modified: trunk/cfg_app_agentcallbacklogin.py
===================================================================
--- trunk/cfg_app_agentcallbacklogin.py	2007-04-20 16:34:23 UTC (rev 667)
+++ trunk/cfg_app_agentcallbacklogin.py	2007-04-25 00:42:28 UTC (rev 668)
@@ -75,5 +75,5 @@
 		c.appendExten(self.ext, "Hangup")
 
 		c.appendExten(self.changeext, "AgentCallbackLogin(${CALLERIDNUM}|%s|'#')" % (opts) )
-		c.appendExten(self.logoutext, "Dial(Local/%s at pbx1/n,,D(#))" % self.changeext)
+		c.appendExten(self.logoutext, "Dial(Local/%s@%s/n,,D(#))" % (self.changeext, self.pbx))
 



From santiago at mail.berlios.de  Wed Apr 25 06:29:37 2007
From: santiago at mail.berlios.de (santiago at BerliOS)
Date: Wed, 25 Apr 2007 06:29:37 +0200
Subject: [Destar-dev] r669 - trunk
Message-ID: <200704250429.l3P4TbVM028162@sheep.berlios.de>

Author: santiago
Date: 2007-04-25 06:29:36 +0200 (Wed, 25 Apr 2007)
New Revision: 669

Modified:
   trunk/CHANGELOG.txt
   trunk/cfg_phone_queue.py
Log:
* cfg_phone_queue: a few more order in the form variables.



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-25 00:42:28 UTC (rev 668)
+++ trunk/CHANGELOG.txt	2007-04-25 04:29:36 UTC (rev 669)
@@ -1,5 +1,6 @@
 2007-04-24:
 * Use actual pbx instead pbx1 in cfg_app_agentcallbacklogin
+* cfg_phone_queue: a few more order in the form variables.
 
 2007-04-20:
 * queues and agents general settings in cfg_opt_queuesagents.py.  

Modified: trunk/cfg_phone_queue.py
===================================================================
--- trunk/cfg_phone_queue.py	2007-04-25 00:42:28 UTC (rev 668)
+++ trunk/cfg_phone_queue.py	2007-04-25 04:29:36 UTC (rev 669)
@@ -46,10 +46,15 @@
 					len=6),
 
 			VarType("timeout",
-					title=_("Phone timeout"),
+					title=_("Agent timeout"),
 					optional=True,
 					len=6),
 
+			VarType("retry",
+					title=_("How long to wait before trying all the members again?"),
+					optional=True,
+					len=6),
+
 	                VarType("queuetimeout",
         	            		title=_("Queue Timeout"),
                                 	optional=True,
@@ -82,11 +87,6 @@
 						("rrmemory",_("Round robin with memory - remember where we left off last ring pass"))), 
 					default="ringall"),
 
-			VarType("retry",
-					title=_("How long to wait before trying all the members again?"),
-					optional=True,
-					len=6),
-	
 			VarType("Announces",
 					title=_("Announces"),
 					type="label",



From dasenjo at mail.berlios.de  Wed Apr 25 22:02:45 2007
From: dasenjo at mail.berlios.de (dasenjo at BerliOS)
Date: Wed, 25 Apr 2007 22:02:45 +0200
Subject: [Destar-dev] r670 - trunk
Message-ID: <200704252002.l3PK2jWK010340@sheep.berlios.de>

Author: dasenjo
Date: 2007-04-25 22:02:44 +0200 (Wed, 25 Apr 2007)
New Revision: 670

Modified:
   trunk/CHANGELOG.txt
   trunk/Makefile
   trunk/cfg_opt_oppanel.py
   trunk/cfg_phone_agent.py
   trunk/configlets.py
   trunk/panelutils.py
Log:
* Added panel buttons for agents. (still does not work at all)
* Allow configuring op_server debug level.



Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-25 04:29:36 UTC (rev 669)
+++ trunk/CHANGELOG.txt	2007-04-25 20:02:44 UTC (rev 670)
@@ -1,3 +1,7 @@
+2007-04-25
+* Added panel buttons for agents. (still does not work at all)
+* Allow configuring op_server debug level.
+
 2007-04-24:
 * Use actual pbx instead pbx1 in cfg_app_agentcallbacklogin
 * cfg_phone_queue: a few more order in the form variables.

Modified: trunk/Makefile
===================================================================
--- trunk/Makefile	2007-04-25 04:29:36 UTC (rev 669)
+++ trunk/Makefile	2007-04-25 20:02:44 UTC (rev 670)
@@ -7,7 +7,7 @@
 MANDIR=$(DESTDIR)/usr/share/man/man8
 
 # To use with asternic.org op_panel tarball:
-#PANEL_HTML_DIR=/usr/local/op_panel/html
+#PANEL_HTML_DIR=/usr/local/op_panel-0.27/flash
 
 # To use with op-panel .deb package:
 PANEL_HTML_DIR=/usr/share/op-panel/flash

Modified: trunk/cfg_opt_oppanel.py
===================================================================
--- trunk/cfg_opt_oppanel.py	2007-04-25 04:29:36 UTC (rev 669)
+++ trunk/cfg_opt_oppanel.py	2007-04-25 20:02:44 UTC (rev 670)
@@ -68,8 +68,14 @@
 				title=_("Frequency in seconds to poll for sip and iax status"),
 				len=10,
 				default="60"),
-		]
 
+			VarType("debug",
+				title=_("Debug level"),
+				len=3,
+				type="int",
+				default=0)]
+
+
 	def createAsteriskConfig(self):
 		c = AstConf("op_server.cfg")
                 c.setSection("general")
@@ -78,6 +84,7 @@
 
 		c.appendValue(self, "security_code")	
 		c.appendValue(self, "poll_interval")	
+		c.appendValue(self, "debug")	
 		panelutils.createManagerConfig(self)
 		panelutils.createDefaultConfig(c)	
 

Modified: trunk/cfg_phone_agent.py
===================================================================
--- trunk/cfg_phone_agent.py	2007-04-25 04:29:36 UTC (rev 669)
+++ trunk/cfg_phone_agent.py	2007-04-25 20:02:44 UTC (rev 670)
@@ -61,8 +61,19 @@
 					type="mchoice",
 					optional=True,
 					options=getChoice("CfgPhoneQueue"),
-					hide=True)]
+					hide=True),
 					
+			VarType("panelLab",
+				title=_("Operator Panel"),
+				type="label",
+				hide=True),
+
+			VarType("panel",
+				title=_("Show this phone in the panel"),
+				type="bool",
+				hide=True,
+				optional=True)]
+					
 		queues = len(configlet_tree.getConfigletsByName('CfgPhoneQueue'))
 		if queues > 0:
 			for v in self.variables:
@@ -76,7 +87,7 @@
 		]
 
 	def createAsteriskConfig(self):
-
+		needModule('chan_agent')
 		ag = AstConf("agents.conf")
 		ag.setSection("agents")
 		if self.secret:
@@ -87,3 +98,4 @@
 
 
 		self.createQueuesConfig()
+		self.createPanelConfig()

Modified: trunk/configlets.py
===================================================================
--- trunk/configlets.py	2007-04-25 04:29:36 UTC (rev 669)
+++ trunk/configlets.py	2007-04-25 20:02:44 UTC (rev 670)
@@ -1115,7 +1115,10 @@
 	def createPanelConfig(self):
 		try:
 			if panelutils.isConfigured() == 1 and self.panel:
-				panelutils.createExtButton(self)
+				if self.technology == 'AGENT':
+					panelutils.createAgentButton(self)
+				else:
+					panelutils.createExtButton(self)
 		except AttributeError:
 			pass
 

Modified: trunk/panelutils.py
===================================================================
--- trunk/panelutils.py	2007-04-25 04:29:36 UTC (rev 669)
+++ trunk/panelutils.py	2007-04-25 20:02:44 UTC (rev 670)
@@ -60,7 +60,6 @@
 	c.append("auth_md5=1")
 	c.append("poll_voicemail=0")
 	c.append("kill_zombies=0")
-	c.append("debug=0")
 	c.append("conference_context=apps")
 	c.append("clid_format=(xxx)xxx-xxxx")
 	c.append("clid_privacy=0")
@@ -122,6 +121,13 @@
 	p.append("Extension=%s" % obj.ext)
 	p.append("Label=%s" % obj.name)
 
+def createAgentButton(obj):
+	p = AstConf("op_buttons.cfg")
+	p.setSection("%s/%s" % (obj.technology, obj.number) )
+	p.append("Position=n")
+	p.append("Icon=6")
+	p.append("Label=%s" % obj.name)
+
 def createTrunkButton(obj):
 	p = AstConf("op_buttons.cfg")
 	p.setSection("%s/%s" % (obj.technology, obj.name) )



From dasenjo at mail.berlios.de  Wed Apr 25 22:12:20 2007
From: dasenjo at mail.berlios.de (dasenjo at BerliOS)
Date: Wed, 25 Apr 2007 22:12:20 +0200
Subject: [Destar-dev] r671 - branches/0.2.X trunk
Message-ID: <200704252012.l3PKCKMZ011198@sheep.berlios.de>

Author: dasenjo
Date: 2007-04-25 22:12:19 +0200 (Wed, 25 Apr 2007)
New Revision: 671

Modified:
   branches/0.2.X/CHANGELOG.txt
   branches/0.2.X/backend.py
   trunk/CHANGELOG.txt
   trunk/backend.py
Log:
* Fixed bug in macro-voicemail: added missing t and T extensions and a priority after calling VoiceMail application.



Modified: branches/0.2.X/CHANGELOG.txt
===================================================================
--- branches/0.2.X/CHANGELOG.txt	2007-04-25 20:02:44 UTC (rev 670)
+++ branches/0.2.X/CHANGELOG.txt	2007-04-25 20:12:19 UTC (rev 671)
@@ -1,3 +1,6 @@
+2007-04-25:
+* Fixed bug in macro-voicemail: added missing t and T extensions and a priority after calling VoiceMail application.
+
 2007-04-19:
 * Fixed bug in the login page.
 

Modified: branches/0.2.X/backend.py
===================================================================
--- branches/0.2.X/backend.py	2007-04-25 20:02:44 UTC (rev 670)
+++ branches/0.2.X/backend.py	2007-04-25 20:12:19 UTC (rev 671)
@@ -275,15 +275,14 @@
 	c.append("; format: Macro(voicemail,<VoiceMail arguments>)")
 	c.append(";")
 	c.setSection("macro-voicemail")
+	c.append("exten => t,1,Hangup()")
+	c.append("exten => T,1,Hangup()")
 	c.append("exten => s,1,Answer")
 	c.append("exten => s,2,Set(TIMEOUT(absolute)=240)")
 	c.append("exten => s,3,Wait(1)")
 	c.append("exten => s,4,VoiceMail(${ARG1})")
-	c.append(";exten => s,105,Macro(dial-result,3)")
+	c.append("exten => s,5,Hangup()")
 
-	c.append(";exten => h,1,Macro(dial-result)")
-	c.append(";exten => t,1,Macro(dial-result)")
-
 	c.append(";")
 	c.append("; format: Macro(dial-result,[<cause>])")
 	c.append(";")

Modified: trunk/CHANGELOG.txt
===================================================================
--- trunk/CHANGELOG.txt	2007-04-25 20:02:44 UTC (rev 670)
+++ trunk/CHANGELOG.txt	2007-04-25 20:12:19 UTC (rev 671)
@@ -1,6 +1,7 @@
 2007-04-25
 * Added panel buttons for agents. (still does not work at all)
 * Allow configuring op_server debug level.
+* Fixed bug in macro-voicemail: added missing t and T extensions and a priority after calling VoiceMail application.
 
 2007-04-24:
 * Use actual pbx instead pbx1 in cfg_app_agentcallbacklogin

Modified: trunk/backend.py
===================================================================
--- trunk/backend.py	2007-04-25 20:02:44 UTC (rev 670)
+++ trunk/backend.py	2007-04-25 20:12:19 UTC (rev 671)
@@ -280,14 +280,14 @@
 	c.append("; format: Macro(voicemail,<VoiceMail arguments>)")
 	c.append(";")
 	c.setSection("macro-voicemail")
+	c.append("exten => t,1,Hangup()")
+	c.append("exten => T,1,Hangup()")
 	c.append("exten => s,1,Answer")
 	c.append("exten => s,2,Set(TIMEOUT(absolute)=240)")
 	c.append("exten => s,3,Wait(1)")
 	c.append("exten => s,4,VoiceMail(${ARG1})")
-	c.append(";exten => s,105,Macro(dial-result,3)")
+	c.append("exten => s,5,Hangup()")
 
-	c.append(";exten => h,1,Macro(dial-result)")
-	c.append(";exten => t,1,Macro(dial-result)")
 
 	c.append(";")
 	c.append("; format: Macro(dial-result,[<cause>])")



From dasenjo at mail.berlios.de  Thu Apr 26 00:52:27 2007
From: dasenjo at mail.berlios.de (dasenjo at BerliOS)
Date: Thu, 26 Apr 2007 00:52:27 +0200
Subject: [Destar-dev] r672 - branches/0.2.X
Message-ID: <200704252252.l3PMqRVk024506@sheep.berlios.de>

Author: dasenjo
Date: 2007-04-26 00:52:26 +0200 (Thu, 26 Apr 2007)
New Revision: 672

Modified:
   branches/0.2.X/CHANGELOG.txt
   branches/0.2.X/cfg_dialout_normal.py
Log:
* Fixed incerdible bug in the timelimit settings for a macro.



Modified: branches/0.2.X/CHANGELOG.txt
===================================================================
--- branches/0.2.X/CHANGELOG.txt	2007-04-25 20:12:19 UTC (rev 671)
+++ branches/0.2.X/CHANGELOG.txt	2007-04-25 22:52:26 UTC (rev 672)
@@ -1,5 +1,6 @@
 2007-04-25:
 * Fixed bug in macro-voicemail: added missing t and T extensions and a priority after calling VoiceMail application.
+* Fixed incerdible bug in the timelimit settings for a macro.
 
 2007-04-19:
 * Fixed bug in the login page.

Modified: branches/0.2.X/cfg_dialout_normal.py
===================================================================
--- branches/0.2.X/cfg_dialout_normal.py	2007-04-25 20:12:19 UTC (rev 671)
+++ branches/0.2.X/cfg_dialout_normal.py	2007-04-25 22:52:26 UTC (rev 672)
@@ -139,7 +139,7 @@
 			c.appendExten("s","GotoIf($[${ARG3} = 0]?5:8)")
 			c.appendExten("s",'Set(timeout=0)')
 			c.appendExten("s",'Set(options=%s)' % opts)
-			c.appendExten("s",'Goto(9)')
+			c.appendExten("s",'Goto(10)')
 		c.appendExten("s",'Set(timeout=%d)' % self.maxtime)
 		c.appendExten("s",'Set(options=%sL(%d000:10000))' % (opts,self.maxtime))
 		#TODO: add this trunks sorted by price and with a default one.



